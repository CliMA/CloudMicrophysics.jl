<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Aerosol Coagulation · CloudMicrophysics.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="CloudMicrophysics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">CloudMicrophysics.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../Microphysics0M/">0-moment precipitation microphysics</a></li><li><a class="tocitem" href="../Microphysics1M/">1-moment precipitation microphysics</a></li><li><a class="tocitem" href="../Microphysics2M/">2-moment precipitation microphysics</a></li><li><a class="tocitem" href="../MicrophysicsNonEq/">Non-equilibrium cloud formation</a></li><li><a class="tocitem" href="../ThresholdsTransition/">Smooth transition at thresholds</a></li><li><a class="tocitem" href="../AerosolActivation/">Aerosol activation</a></li><li><a class="tocitem" href="../ARG2000_example/">ARG2000 activation example</a></li><li class="is-active"><a class="tocitem" href>Aerosol Coagulation</a><ul class="internal"><li><a class="tocitem" href="#Quadrature"><span>Quadrature</span></a></li><li><a class="tocitem" href="#Substitution-based-Approximation"><span>Substitution-based Approximation</span></a></li></ul></li><li><a class="tocitem" href="../API/">API</a></li><li><a class="tocitem" href="../References/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Aerosol Coagulation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Aerosol Coagulation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/CliMA/CloudMicrophysics.jl/blob/main/docs/src/AerosolCoagulation.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Aerosol-Coagulation"><a class="docs-heading-anchor" href="#Aerosol-Coagulation">Aerosol Coagulation</a><a id="Aerosol-Coagulation-1"></a><a class="docs-heading-anchor-permalink" href="#Aerosol-Coagulation" title="Permalink"></a></h1><p>Aerosol coagulation describes the formation of a new particle via collision of two particles from the same or different modes. In MAM3 (and our implementation), coagulation rates and effects are computed by moment and mode.  According to <a href="../References/#Liu2012">X. Liu (2012)</a>, coagulation involving modes with sizes larger than the accumulation mode is very slow and is therefore neglected. Intramodal coagulation reduces number and leaves mass unchanged. For intermodal coagulation, mass is transferred to the mode with the larger mean size. The number concentration for the smaller mode decreases, while the larger mode stays constant. The change to a given mode and moment is given by the following integral over the distribution sizes of the two given modes:</p><p class="math-container">\[\frac{\partial }{\partial t}(M_{k_{i}}) = \Gamma_T \int_{0}^{\infty}\int_{0}^{\infty}
f_k(d_{p_1}, d_{p_2})\gamma(d_{p_1}, d_{p_2})n_i(d_{p_1})n_j(d_{p_2})
d(\text{ln}d_{p_1})d(\text{ln}d_{p_2})\]</p><p>where </p><ul><li><span>$\Gamma_T$</span> is the non size-dependent term</li><li><span>$f_k$</span> is the moment factor (<span>$d^p$</span>, where <span>$p$</span> is the moment)</li><li><span>$\gamma$</span> is the size-dependent coagulation rate, equivalent to <span>$\beta$</span> below</li><li><span>$n_i$</span> and <span>$n_j$</span> are the number concentrations of the given modes (<span>$i$</span>,<span>$j$</span>) at the given diameters (<span>$d_{p_1}$</span>, <span>$d_{p_2}$</span>)</li></ul><h4 id="Intramodal-Coagulation"><a class="docs-heading-anchor" href="#Intramodal-Coagulation">Intramodal Coagulation</a><a id="Intramodal-Coagulation-1"></a><a class="docs-heading-anchor-permalink" href="#Intramodal-Coagulation" title="Permalink"></a></h4><p>The change to the 0-th moment due to intramodal coagulation is as follows:</p><p class="math-container">\[\begin{equation}
\frac{\partial }{\partial t}(M_{0_{i}}) = -\frac{1}{2}\int_{0}^{\infty}\int_{0}^{\infty}
d^{0}_{p_{1}}\beta_(d_{p_{1}},d_{p_{2}})
n_{i}(d_{p_{1}})n_{i}(d_{p_{2}})\text{d}d_{p_{1}}\text{d}d_{p_{2}}
\end{equation}\]</p><p>The change to the 2nd moment due to intramodal coagulation is given by:</p><p class="math-container">\[\begin{equation}
\frac{\partial }{\partial t}(M_{2_{i}}) = \int_{0}^{\infty}\int_{0}^{\infty}
d^{0}_{p_{1}}\beta_(d_{p_{1}},d_{p_{2}})
n_{i}(d_{p_{1}})n_{i}(d_{p_{2}})\text{d}d_{p_{1}}\text{d}d_{p_{2}}
\end{equation}\]</p><p>Since intramodal coagulation conserves mass, the 3rd moment change is zero.</p><h4 id="Intermodal-coagulation"><a class="docs-heading-anchor" href="#Intermodal-coagulation">Intermodal coagulation</a><a id="Intermodal-coagulation-1"></a><a class="docs-heading-anchor-permalink" href="#Intermodal-coagulation" title="Permalink"></a></h4><p>Intermodal coagulation integrals take the following form for the <span>$k$</span>-th moment:</p><p class="math-container">\[\begin{equation}
\frac{\partial }{\partial t}(M_{k_{i}}) = 
-\int_{0}^{\infty}\int_{0}^{\infty}
d^{k}_{p_{1}}\beta(d_{p_{1}},d_{p_{2}})
n_{i}(d_{p_{1}})n_{j}(d_{p_{2}})\text{d}d_{p_{1}}\text{d}d_{p_{2}}
\end{equation}\]</p><p>The <code>Coagulation.jl</code> module contains analytical expressions for the coagulation integrals of the modal dynamics equations. The module has two methods for approximating these integrals: quadrature, and approximation of the size-dependent coagulation rate terms.</p><h2 id="Quadrature"><a class="docs-heading-anchor" href="#Quadrature">Quadrature</a><a id="Quadrature-1"></a><a class="docs-heading-anchor-permalink" href="#Quadrature" title="Permalink"></a></h2><p>Quadrature is computed using the <a href="https://github.com/JuliaMath/Cubature.jl">Cubature.jl</a> package. Following Binkowski and Shankar, 1995, <span>$\beta(d_{p_{1}},d_{p_{2}})$</span> has two forms, dependent on the Knudsen regime.  For the free-molecule regime,</p><p class="math-container">\[\begin{equation}
\beta_{fm}(d_{p_{1}},d_{p_{2}})=
\sqrt{\frac{3k_BT}{\rho_p}}
\sqrt{\frac{1}{d_{p_1}^3}+\frac{1}{d_{p_2}^3}}
(d_{p_1}+d_{p_2})^2
\end{equation}\]</p><p>where</p><ul><li><span>$k_B$</span> is the Boltzmann constant</li><li><span>$T$</span> is temperature (K)</li><li><span>$\rho_p$</span> is the particle density for the given mode.</li></ul><p>For the near-continuum regime, </p><p class="math-container">\[\begin{equation}
\beta_{nc}(d_{p_{1}},d_{p_{2}})=
\frac{2k_BT}{3\mu}(d_{p_1} + d_{p_2})

[\frac{1}{d_{p_1}}+\frac{1}{d_{p_2}}+
2.492\lambda(\frac{1}{d_{p_1}^2}+\frac{1}{d_{p_2}^2})
]
\end{equation}\]</p><p>where</p><ul><li><span>$\mu$</span> is the gas viscosity</li><li><span>$\lambda$</span> is the mean free path</li></ul><h2 id="Substitution-based-Approximation"><a class="docs-heading-anchor" href="#Substitution-based-Approximation">Substitution-based Approximation</a><a id="Substitution-based-Approximation-1"></a><a class="docs-heading-anchor-permalink" href="#Substitution-based-Approximation" title="Permalink"></a></h2><p>For the substitution-based approximation, a full derivation of these expressions is found in Appendix H of <a href="../References/#Whitby1991">Evan R. Whitby, Peter H. McMurry, Uma Shankar, Francis S. Binkowski (1991)</a>,  but an example of 0-th moment change due to intramodal coagulation for the <span>$i$</span>-th mode is included below:</p><p class="math-container">\[\begin{equation}
\frac{\partial }{\partial t}(M_{0_{i}}) = -\frac{1}{2}\int_{0}^{\infty}\int_{0}^{\infty}
d^{0}_{p_{1}}\beta(d_{p_{1}},d_{p_{2}})
n_{i}(d_{p_{1}})n_{i}(d_{p_{2}})\text{d}d_{p_{1}}\text{d}d_{p_{2}}
\end{equation}\]</p><p>where <span>$d_p$</span> is the particle diameter (m). <span>$beta_{fm}(d_{p_{1}},d_{p_{2}})$</span> is the same as in the Quadrature section, and <span>$\beta_{nc}(d_{p_{1}},d_{p_{2}})$</span>, the coagulation coefficient <span>$(m^3/s)$</span> is given by:</p><p class="math-container">\[\begin{equation}
\beta_{nc}(d_{p_{1}},d_{p_{2}}) = 2\pi (D_{p_1} + D_{p_2})(d_{p_1} + d_{p_2})
\end{equation}\]</p><p>where  <span>$D_p$</span> is the particle diffusion coefficient <span>$(m^2/s)$</span>:</p><p class="math-container">\[D_p = [k_B\cdot T\cdot C_C /(3\pi\mu d_p)]
\\
C_C \approx 1 + A \cdot Kn
\\
A = 1.392Kn_{g}^{0.0783}
\\
Kn_g = 2\lambda/D_{gn}\]</p><p>where: </p><ul><li><span>$Kn$</span> is the Knudsen number for air at the given temperature and pressure (m)</li><li><span>$\lambda$</span> is the mean free path <span>$(m)$</span></li><li><span>$D_{gn}$</span> is the average diameter of the <span>$i$</span>-th mode <span>$(m)$</span></li></ul><p>Substituting <span>$(2)$</span> into <span>$(1)$</span> yields:</p><p class="math-container">\[\frac{1}{2}\int_{0}^{\infty}\int_{0}^{\infty}
d^{0}_{p_{1}}\beta_{nc}(d_{p_{1}},d_{p_{2}})
n_{i}(d_{p_{1}})n_{i}(d_{p_{2}})\text{d}d_{p_{1}}\text{d}d_{p_{2}}
=
N_{i}^{2}K_{nc} [1 + \text{ESG}_i^8 + A_i Kn_{g_i}(\text{ESG}_i^{20}+\text{ESG}_i^4)]\]</p><p>where:</p><ul><li><span>$N_i$</span> is the number concentration of the <span>$i$</span>-th mode <span>$(1/m^3)$</span></li><li><span>$K_{nc} = \sqrt{2k_B T / 3\mu}$</span> is the non size-dependent term for the continuum/near-continuum coagulation coefficient <span>$(m^3/s)$</span>, and <span>$\mu$</span> is the gas viscosity <span>$[kg/(m\cdot s)]$</span></li><li><span>$ESG_i = exp(1/8 \cdot ln^2 \sigma_g)$</span>, where <span>$\sigma_g$</span> is the geometric standard deviation of the <span>$i$</span>-th mode</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ARG2000_example/">« ARG2000 activation example</a><a class="docs-footer-nextpage" href="../API/">API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Tuesday 7 March 2023 18:14">Tuesday 7 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
