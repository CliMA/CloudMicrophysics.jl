<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Ice Nucleation · CloudMicrophysics.jl</title><meta name="title" content="Ice Nucleation · CloudMicrophysics.jl"/><meta property="og:title" content="Ice Nucleation · CloudMicrophysics.jl"/><meta property="twitter:title" content="Ice Nucleation · CloudMicrophysics.jl"/><meta name="description" content="Documentation for CloudMicrophysics.jl."/><meta property="og:description" content="Documentation for CloudMicrophysics.jl."/><meta property="twitter:description" content="Documentation for CloudMicrophysics.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="CloudMicrophysics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">CloudMicrophysics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2"><span class="docs-label">Parameterizations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../Microphysics0M/">0-moment precipitation microphysics</a></li><li><a class="tocitem" href="../Microphysics1M/">1-moment precipitation microphysics</a></li><li><a class="tocitem" href="../Microphysics2M/">2-moment precipitation microphysics</a></li><li><a class="tocitem" href="../P3Scheme/">P3 Scheme</a></li><li><a class="tocitem" href="../MicrophysicsNonEq/">Non-equilibrium cloud formation</a></li><li><a class="tocitem" href="../ThresholdsTransition/">Smooth transition at thresholds</a></li><li><a class="tocitem" href="../AerosolActivation/">Aerosol activation</a></li><li><a class="tocitem" href="../WaterActivity/">Water Activity</a></li><li class="is-active"><a class="tocitem" href>Ice Nucleation</a><ul class="internal"><li><a class="tocitem" href="#Activated-fraction-for-deposition-freezing-on-dust"><span>Activated fraction for deposition freezing on dust</span></a></li><li><a class="tocitem" href="#Immersion-Freezing"><span>Immersion Freezing</span></a></li><li><a class="tocitem" href="#Homogeneous-Freezing"><span>Homogeneous Freezing</span></a></li><li><a class="tocitem" href="#Water-Activity-Based-vs-P3-Ice-Nucleation-Parameterizations"><span>Water Activity Based vs P3 Ice Nucleation Parameterizations</span></a></li><li><a class="tocitem" href="#INP-Concentration-Frequency"><span>INP Concentration Frequency</span></a></li></ul></li><li><a class="tocitem" href="../AerosolNucleation/">Aerosol Nucleation</a></li><li><a class="tocitem" href="../PrecipitationSusceptibility/">Precipitation Susceptibility</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">How to guides</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../guides/literated/GettingStarted/">Getting started</a></li><li><a class="tocitem" href="../guides/literated/Parameters/">Handling parameters</a></li><li><a class="tocitem" href="../guides/literated/SimpleModel/">Building a model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../IceNucleationParcel0D/">Adiabatic parcel model</a></li><li><a class="tocitem" href="../IceNucleationBox0D/">Box Model</a></li></ul></li><li><a class="tocitem" href="../API/">API</a></li><li><a class="tocitem" href="../DevelopersGuide/">Developer&#39;s Guide</a></li><li><a class="tocitem" href="../Glossary/">Glossary</a></li><li><a class="tocitem" href="../References/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Parameterizations</a></li><li class="is-active"><a href>Ice Nucleation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Ice Nucleation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CliMA/CloudMicrophysics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CliMA/CloudMicrophysics.jl/blob/main/docs/src/IceNucleation.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Ice-Nucleation"><a class="docs-heading-anchor" href="#Ice-Nucleation">Ice Nucleation</a><a id="Ice-Nucleation-1"></a><a class="docs-heading-anchor-permalink" href="#Ice-Nucleation" title="Permalink"></a></h1><p>Ice nucleation describes the process of forming ice crystals   from aerosol particles and/or liquid droplets. The <code>IceNucleation.jl</code> module includes:</p><ul><li>the parameterization of activation of dust aerosol particles into ice crystals via deposition of water vapor,</li><li>water activity based parameterization of immersion freezing,</li><li>water activity based parameterization of homogeneous freezing,</li><li>parametrization of temperature-dependent aerosol-independent ice nucleating particles concentration for immersion freezing.</li></ul><p>The parameterization for deposition on dust particles is an implementation of   the empirical formulae from [<a href="../References/#Mohler2006">43</a>]   and is valid for two types of dust particles:   Arizona Test Dust and desert dust from Sahara.   The parameterization for immersion freezing is an implementation of [<a href="../References/#KnopfAlpert2013">32</a>]   and is valid for droplets containing sulphuric acid.   The parameterization for homogeneous freezing is an implementation of [<a href="../References/#Koop2000">40</a>].   The parametrization for ice nucleating particles concentration for immersion freezing is an implementation of [<a href="../References/#Frostenberg2023">44</a>].</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Future work includes refining the homogeneous freezing parameterization and modeling the competition between freezing modes.</p></div></div><h2 id="Activated-fraction-for-deposition-freezing-on-dust"><a class="docs-heading-anchor" href="#Activated-fraction-for-deposition-freezing-on-dust">Activated fraction for deposition freezing on dust</a><a id="Activated-fraction-for-deposition-freezing-on-dust-1"></a><a class="docs-heading-anchor-permalink" href="#Activated-fraction-for-deposition-freezing-on-dust" title="Permalink"></a></h2><p>There are 2 parameterizations from [<a href="../References/#Mohler2006">43</a>] available: one   which calculates the activated fraction and one which calculates nucleation   rate.  The activated fraction parameterization follows eq. (3) in the paper.</p><p class="math-container">\[\begin{equation}
f_i(S_i) = exp[a(S_i - S_0)] - 1
\end{equation}\]</p><p>where </p><ul><li><span>$f_i$</span> is the activated fraction  (the ratio of aerosol particles acting as ice nuclei to the total number of aerosol particles),</li><li><span>$a$</span> is a scaling parameter dependent on aerosol properties and temperature,</li><li><span>$S_i$</span> is the ice saturation ratio,</li><li><span>$S_0$</span> is an empirically derived threshold ice saturation ratio.</li></ul><p>The other parameterization models the nucleation rate of ice   as an empirical function of ice saturation ratio,   see eq. (5) in [<a href="../References/#Mohler2006">43</a>].</p><p class="math-container">\[\begin{equation}
\frac{dn_{ice}}{dt} = N_{aer} a \frac{dS_i}{dt}
\end{equation}\]</p><p>where:</p><ul><li><span>$N_{aer}$</span> is the number of available aerosol/ice nuclei,</li><li><span>$a$</span> is a scaling parameter dependent on aerosol properties and temperature,</li><li><span>$S_i$</span> is the ice saturation ratio (the ratio of water vapor partial pressure and the water vapor partial pressure at saturation over ice).</li></ul><p>Limited experimental values for the free parameters <span>$a$</span> and <span>$S_0$</span> can be found in [<a href="../References/#Mohler2006">43</a>]. These   free parameters are strongly dependent on aerosol properties and temperature.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>For <span>$f_i$</span> values above 0.08 or <span>$S_i$</span> between 1.35 and 1.5, freezing occurs in a different ice nucleation mode (either a second deposition or other condensation type mode).</p></div></div><h3 id="Water-Activity-Based-Deposition-Nucleation"><a class="docs-heading-anchor" href="#Water-Activity-Based-Deposition-Nucleation">Water Activity Based Deposition Nucleation</a><a id="Water-Activity-Based-Deposition-Nucleation-1"></a><a class="docs-heading-anchor-permalink" href="#Water-Activity-Based-Deposition-Nucleation" title="Permalink"></a></h3><p>The water activity based deposition nucleation model is analagous to ABIFM   for immersion freezing (see <a href="https://clima.github.io/CloudMicrophysics.jl/dev/IceNucleation/#ABIFM-for-Sulphuric-Acid-Containing-Droplets">ABIFM for Sulphuric Acid Containing Droplets</a>   section below). It calculates a nucleation rate coefficient, <span>$J$</span>, which   describes the number of ice nuclei formed per unit area of INP per unit time   dependent on the water activity criterion, <span>$\Delta  a_w$</span>, and aerosol type.   The form of this empirical parameterization is taken from [<a href="../References/#KnopfAlpert2013">32</a>].   Currently, we have parameters for kaolinite, feldspar, and ferrihydrite derived   from [<a href="../References/#China2017">45</a>] and [<a href="../References/#Alpert2022">46</a>].</p><p class="math-container">\[\begin{equation}
  log_{10}J_{deposition} = m \Delta a_w + c
\end{equation}\]</p><p>where <span>$J$</span> is in units of <span>$cm^{-2}s^{-1}$</span>. Note that our source code returns   <span>$J$</span> in SI units. <span>$m$</span> and <span>$c$</span> are aerosol dependent coefficients. They will   have different values than those for ABIFM.</p><h3 id="Water-activity-based-deposition-nucleation-plot"><a class="docs-heading-anchor" href="#Water-activity-based-deposition-nucleation-plot">Water activity based deposition nucleation plot</a><a id="Water-activity-based-deposition-nucleation-plot-1"></a><a class="docs-heading-anchor-permalink" href="#Water-activity-based-deposition-nucleation-plot" title="Permalink"></a></h3><p>The following plot shows <span>$J$</span> as a function of <span>$\Delta a_w$</span> as compared to   figure 6 in Alpert et al 2013 and figure S5 in supplementary material of China et al 2017. Intent of this   plot is to prove that <span>$J$</span> is correctly parameterized as a function   of <span>$\Delta a_w$</span>, with no implications of whether <span>$\Delta a_w$</span> is properly   parameterized. For more on water activity, please see above section.</p><pre><code class="language-julia hljs">include(&quot;plots/activity_based_deposition.jl&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;/home/runner/work/CloudMicrophysics.jl/CloudMicrophysics.jl/docs/build/water_activity_depo_nuc.svg&quot;</code></pre><p><img src="../water_activity_depo_nuc.svg" alt/></p><h3 id="Cooper-(1986)-Ice-Crystal-Number"><a class="docs-heading-anchor" href="#Cooper-(1986)-Ice-Crystal-Number">Cooper (1986) Ice Crystal Number</a><a id="Cooper-(1986)-Ice-Crystal-Number-1"></a><a class="docs-heading-anchor-permalink" href="#Cooper-(1986)-Ice-Crystal-Number" title="Permalink"></a></h3><p>The P3 scheme as described in [<a href="../References/#MorrisonMilbrandt2015">24</a>] follows   the implementation of [<a href="../References/#Thompson2004">47</a>] where a parameterization from   Cooper 1986 was used. Number of ice crystals formed is derived from   ambient temperature.</p><p class="math-container">\[\begin{equation}
  N_i = 0.005 exp[0.304(T_0 - T)]
\end{equation}\]</p><p>Where <span>$T_0 = 273.15K$</span> and <span>$T$</span> is the ambient temperature. Because the parameterization is prone to overpredict at low temperatures,   <span>$N_i = N_i(T = 233K)$</span> for all values of <span>$N_i$</span> at which <span>$T &lt; 233K$</span>.</p><h2 id="Immersion-Freezing"><a class="docs-heading-anchor" href="#Immersion-Freezing">Immersion Freezing</a><a id="Immersion-Freezing-1"></a><a class="docs-heading-anchor-permalink" href="#Immersion-Freezing" title="Permalink"></a></h2><h3 id="ABIFM-for-Sulphuric-Acid-Containing-Droplets"><a class="docs-heading-anchor" href="#ABIFM-for-Sulphuric-Acid-Containing-Droplets">ABIFM for Sulphuric Acid Containing Droplets</a><a id="ABIFM-for-Sulphuric-Acid-Containing-Droplets-1"></a><a class="docs-heading-anchor-permalink" href="#ABIFM-for-Sulphuric-Acid-Containing-Droplets" title="Permalink"></a></h3><p>Water Activity-Based Immersion Freezing Model (ABFIM)   is a method of parameterizing immersion freezing inspired by the time-dependent   classical nucleation theory (CNT). More on CNT can be found in [<a href="../References/#Karthika2016">48</a>].   The nucleation rate coefficient, <span>$J$</span>, describes the number of ice nuclei formed per unit area   per unit time and can be determined by the water activity, <span>$a_w$</span>. This parameterization follows   [<a href="../References/#KnopfAlpert2013">32</a>]. In this model, aerosols are assumed to contain an insoluble and   soluble material. When immersed in water, the soluble material diffuses into the liquid water   to create a sulphuric acid solution.</p><p>Using empirical coefficients, <span>$m$</span> and <span>$c$</span>, from [<a href="../References/#KnopfAlpert2013">32</a>],   the heterogeneous nucleation rate coefficient in units of <span>$cm^{-2}s^{-1}$</span>   can be determined by the linear equation</p><p class="math-container">\[\begin{equation}
  log_{10}J_{ABIFM} = m \Delta a_w + c
\end{equation}\]</p><p>A parameterization for <span>$\Delta a_w$</span> can be found in <code>Common.jl</code>. More information on   it can be found in the <code>Water Activity</code> section. <span>$m$</span> and <span>$c$</span> here are different   from the <span>$m$</span> and <span>$c$</span> parameters for deposition nucleation.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Our source code for the nucleation rate coefficient returns <span>$J$</span> in base SI units.</p></div></div><p>Once <span>$J_{ABIFM}$</span> is calculated, it can be used to determine the ice production rate, <span>$P_{ice}$</span>, per second via immersion freezing.</p><p class="math-container">\[\begin{equation}
  P_{ice} = J_{ABIFM}A(N_{aer} - N_{ice})
\end{equation}\]</p><p>where <span>$A$</span> is surface area of an individual ice nuclei, <span>$N_{aer}$</span> is total number   of ice nuclei, and <span>$N_{ice}$</span> is number of ice crystals already in the system.</p><h3 id="ABIFM-Example-Figures"><a class="docs-heading-anchor" href="#ABIFM-Example-Figures">ABIFM Example Figures</a><a id="ABIFM-Example-Figures-1"></a><a class="docs-heading-anchor-permalink" href="#ABIFM-Example-Figures" title="Permalink"></a></h3><p>The following plot shows <span>$J$</span> as a function of <span>$\Delta a_w$</span> as compared to   figure 1 in Knopf &amp; Alpert 2013. Solution droplets were assumed to contain   a constant 10% wt. sulphuric acid. Changing the concentration will simply   shift the line, following Knopf &amp; Alpert&#39;s parameterization. As such, this   plot is just to prove that <span>$J$</span> is correctly parameterized as a function   of <span>$\Delta a_w$</span>, with no implications of whether <span>$\Delta a_w$</span> is properly   parameterized. For more on water activity, please see above section.</p><pre><code class="language-julia hljs">include(&quot;plots/KnopfAlpert2013_fig1.jl&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;/home/runner/work/CloudMicrophysics.jl/CloudMicrophysics.jl/docs/build/Knopf_Alpert_fig_1.svg&quot;</code></pre><p><img src="../Knopf_Alpert_fig_1.svg" alt/></p><p>The following plot shows J as a function of temperature as compared to figure 5a in Knopf &amp; Alpert 2013.</p><pre><code class="language-julia hljs">include(&quot;plots/KnopfAlpert2013_fig5.jl&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">CairoMakie.Screen{SVG}
</code></pre><p><img src="../KnopfAlpert2013_fig5.svg" alt/> Note that water activity of the droplet was assumed equal to relative humidity so that:</p><p class="math-container">\[\begin{equation}
  a_{w} = \frac{p_{sat}(T = T_{dew})}{p_{sat}(T)}
\end{equation}\]</p><p>where <code>T_dew</code> is the dewpoint (in this example, it is constant at -45C).</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>For the same figure in Knopf &amp; Alpert, the mixed-phase cloud uses T<em>{dew} = T. We are unsure when to use constant T</em>{dew} or set it equal to T.</p></div></div><p>It is also important to note that this plot is reflective of cirrus clouds   and shows only a very small temperature range. The two curves are slightly   off because of small differences in parameterizations for vapor pressures.</p><h3 id="Bigg-(1953)-Volume-and-Time-Dependent-Heterogeneous-Freezing"><a class="docs-heading-anchor" href="#Bigg-(1953)-Volume-and-Time-Dependent-Heterogeneous-Freezing">Bigg (1953) Volume and Time Dependent Heterogeneous Freezing</a><a id="Bigg-(1953)-Volume-and-Time-Dependent-Heterogeneous-Freezing-1"></a><a class="docs-heading-anchor-permalink" href="#Bigg-(1953)-Volume-and-Time-Dependent-Heterogeneous-Freezing" title="Permalink"></a></h3><p>Heterogeneous freezing in the P3 scheme as described in [<a href="../References/#MorrisonMilbrandt2015">24</a>]   follows the parameterization from [<a href="../References/#Bigg1953">49</a>] with parameters from    [<a href="../References/#BarklieGokhale1959">50</a>]. The number of ice nucleated in a timestep via   heterogeneous freezing is determined by</p><p class="math-container">\[\begin{equation}
  N_{ice} = N_{liq} \left[ 1 - exp(-B V_{l} \Delta t exp(aT_s)) \right]
\end{equation}\]</p><p>where <code>a</code> and <code>B</code> are parameters taken from [<a href="../References/#BarklieGokhale1959">50</a>] for   rainwater as 0.65 and 2e-4 respectively. <code>T_s</code> is the difference between   273.15K and ambient temperature. <code>V_l</code> is the volume of droplets to be   frozen and <code>\Delta t</code> is timestep in which freezing occurs.</p><h2 id="Homogeneous-Freezing"><a class="docs-heading-anchor" href="#Homogeneous-Freezing">Homogeneous Freezing</a><a id="Homogeneous-Freezing-1"></a><a class="docs-heading-anchor-permalink" href="#Homogeneous-Freezing" title="Permalink"></a></h2><h3 id="Homogeneous-Freezing-for-Sulphuric-Acid-Containing-Droplets"><a class="docs-heading-anchor" href="#Homogeneous-Freezing-for-Sulphuric-Acid-Containing-Droplets">Homogeneous Freezing for Sulphuric Acid Containing Droplets</a><a id="Homogeneous-Freezing-for-Sulphuric-Acid-Containing-Droplets-1"></a><a class="docs-heading-anchor-permalink" href="#Homogeneous-Freezing-for-Sulphuric-Acid-Containing-Droplets" title="Permalink"></a></h3><p>Homogeneous freezing occurs when supercooled liquid droplets freeze on their own.   Closly based off [<a href="../References/#Koop2000">40</a>], this parameterization determines a homoegneous nucleation   rate coefficient, <span>$J_{hom}$</span>, using water activity. The change in water activity,   <span>$\Delta a_w(c,T,P)$</span>, can be found in <code>Common.jl</code> and is described in the   <code>Water Activity section</code>. It is then used to empirically calculate <span>$J_{hom}(\Delta a_w)$</span>   with units of <span>$cm^{-3}s^{-1}$</span>.</p><p>The nucleation rate coefficient is determined with the cubic function from [<a href="../References/#Koop2000">40</a>]</p><p class="math-container">\[\begin{equation}
  logJ_{hom} = -906.7 + 8502 \Delta a_w - 26924(\Delta a_w)^2 + 29180(\Delta a_w)^3
\end{equation}\]</p><p>This parameterization is valid only when <span>$0.26 &lt; \Delta a_w &lt; 0.36$</span> and <span>$185K &lt; T &lt; 235K$</span>.</p><h3 id="Homogeneous-Freezing-Example-Figures"><a class="docs-heading-anchor" href="#Homogeneous-Freezing-Example-Figures">Homogeneous Freezing Example Figures</a><a id="Homogeneous-Freezing-Example-Figures-1"></a><a class="docs-heading-anchor-permalink" href="#Homogeneous-Freezing-Example-Figures" title="Permalink"></a></h3><p>Here is a comparison of our parameterization of <span>$J_{hom}$</span> compared to Koop 2000 as   plotted in figure 1 of [<a href="../References/#Spichtinger2023">51</a>]. Our parameterization differs in the calculation   of <span>$\Delta a_w$</span>. We define water activity to be a ratio of saturated vapor pressures whereas   Koop 2000 uses the difference in chemical potential.</p><pre><code class="language-julia hljs">include(&quot;plots/HomFreezingPlots.jl&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">CairoMakie.Screen{SVG}
</code></pre><p><img src="../HomFreezingPlots.svg" alt/></p><p>It should be noted that the Koop 2000   parameterization is only valid for temperatures up to 240K and a temperature-dependent max   pressure. The max valid pressure becomes negative around 237K, so the Koop 2000 parameterizaiton   should not be valid beyond 237K. For this reason, we limit the curve from [<a href="../References/#Spichtinger2023">51</a>]   to 237K.</p><p>Multiple sulphuric acid concentrations, <span>$x$</span>,   are plotted since the actual concentration used in literature values is unspecified.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Spichtinger plot may be under the condition that x = 0 (pure liquid droplets). The current parameterization in CloudMicrophysics.jl is not valid for \Delta a_w values that are obtained from pure water droplets. Though CliMA lines look far from the Spichtinger 2023 line, the lines seem to move closer as x approaches 0.</p></div></div><h3 id="Linear-fit-homogeneous-freezing"><a class="docs-heading-anchor" href="#Linear-fit-homogeneous-freezing">Linear fit homogeneous freezing</a><a id="Linear-fit-homogeneous-freezing-1"></a><a class="docs-heading-anchor-permalink" href="#Linear-fit-homogeneous-freezing" title="Permalink"></a></h3><p>To avoid complications in extrapolating the Koop 2000 parameterization outside of the valide temperature range, a linear fit was created.</p><pre><code class="language-julia hljs">include(&quot;plots/linear_HOM_J.jl&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">CairoMakie.Screen{SVG}
</code></pre><p><img src="../linear_HOM_J.svg" alt/></p><h2 id="Water-Activity-Based-vs-P3-Ice-Nucleation-Parameterizations"><a class="docs-heading-anchor" href="#Water-Activity-Based-vs-P3-Ice-Nucleation-Parameterizations">Water Activity Based vs P3 Ice Nucleation Parameterizations</a><a id="Water-Activity-Based-vs-P3-Ice-Nucleation-Parameterizations-1"></a><a class="docs-heading-anchor-permalink" href="#Water-Activity-Based-vs-P3-Ice-Nucleation-Parameterizations" title="Permalink"></a></h2><p>The water activity based models are compared with P3 ice nucleation parameterizations as described   in [<a href="../References/#MorrisonMilbrandt2015">24</a>] using an adiabatic parcel model with depositional growth. The   first row of plots shows deposition nucleation; the second row shows heterogeneous freezing; the   last row shows homogeneous freezing.</p><pre><code class="language-julia hljs">include(&quot;../../parcel/Example_P3_vs_activitybased.jl&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">CairoMakie.Screen{SVG}
</code></pre><p><img src="../P3_vs_activitybased.svg" alt/></p><p>For the activity based deposition ice nucleation model (ABDINM):</p><ul><li>Green corresponds to feldspar,</li><li>Orange corresponds to ferrihydrite,</li><li>Magenta corresponds to kaolinite.</li></ul><p>We note that the P3 deposition parameterization shows a significantly greater ICNC at all times in   the simulation. This is expected because the parameterization does not account for the number of   available INP.</p><p>For the activity based immersion freezing model (ABIFM):</p><ul><li>Green corresponds to desert dust,</li><li>Orange corresponds to illite,</li><li>Magenta corresponds to kaolinite.</li></ul><p>The P3 heterogeneous parameterization also shows much more ICNC than any of the ABIFM runs. It   should be noted that the P3 parameterization does not distinguish between immersion freezing,   contact freezing, etc. </p><p>The P3 scheme allows homogeneous freezing to freeze all droplets at temperatures equal to or less than 233.15K. No homogeneous freezing occurs at warmer temperatures.</p><h2 id="INP-Concentration-Frequency"><a class="docs-heading-anchor" href="#INP-Concentration-Frequency">INP Concentration Frequency</a><a id="INP-Concentration-Frequency-1"></a><a class="docs-heading-anchor-permalink" href="#INP-Concentration-Frequency" title="Permalink"></a></h2><p>With this parametrization, the concentration of ice nucleating particles (INPs) is found based on the relative frequency distribution, which depends on the temperature, but does not depend on aerosol types. It is based on [<a href="../References/#Frostenberg2023">44</a>] and is derived from measurements, for marine data sets. It is a lognormal distribution, described by</p><p class="math-container">\[\begin{equation}
  D(\mu, \sigma^2) = \frac{1}{\sqrt{2 \pi} \sigma} exp \left(- \frac{[ln(a \cdot INPC) - \mu(T)]^2}{2 \sigma^2} \right),
\end{equation}\]</p><p>where <span>$T$</span> is the temperature in degrees Celsius, <span>$INPC$</span> is the INP concentration in m<span>$^{-3}$</span> and the temperature-dependent mean <span>$\mu(T)$</span> is given by</p><p class="math-container">\[\begin{equation}
  \mu(T) = ln(-(b \cdot T)^9 \times 10^{-9})
\end{equation}\]</p><p><span>$\sigma^2$</span> is the variance, <span>$a$</span> and <span>$b$</span> are coefficients. The parameters defined in [<a href="../References/#Frostenberg2023">44</a>] for marine data sets are <span>$\sigma=1.37$</span>, <span>$a=1$</span> m<span>$^3$</span>, <span>$b=1$</span>/C.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Our implementation uses base SI units and takes <span>$T$</span> in Kelvin.</p></div></div><p>The following plot shows the relative frequency distribution for INPCs, as a function of temperature (the same as figure 1 in [<a href="../References/#Frostenberg2023">44</a>]). </p><pre><code class="language-julia hljs">include(&quot;plots/Frostenberg_fig1.jl&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;/home/runner/work/CloudMicrophysics.jl/CloudMicrophysics.jl/docs/build/Frostenberg_fig1_T16.svg&quot;</code></pre><p><img src="../Frostenberg_fig1.svg" alt/></p><p>The following plot shows the relative frequency distribution for INPCs at the temperature <span>$T=-16 C$</span>.</p><p><img src="../Frostenberg_fig1_T16.svg" alt/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../WaterActivity/">« Water Activity</a><a class="docs-footer-nextpage" href="../AerosolNucleation/">Aerosol Nucleation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.6.0 on <span class="colophon-date" title="Friday 23 August 2024 18:18">Friday 23 August 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
