<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Box model ice nucleation example · CloudMicrophysics.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="CloudMicrophysics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">CloudMicrophysics.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../Microphysics0M/">0-moment precipitation microphysics</a></li><li><a class="tocitem" href="../Microphysics1M/">1-moment precipitation microphysics</a></li><li><a class="tocitem" href="../Microphysics2M/">2-moment precipitation microphysics</a></li><li><a class="tocitem" href="../P3Scheme/">P3 Scheme</a></li><li><a class="tocitem" href="../MicrophysicsNonEq/">Non-equilibrium cloud formation</a></li><li><a class="tocitem" href="../ThresholdsTransition/">Smooth transition at thresholds</a></li><li><a class="tocitem" href="../AerosolActivation/">Aerosol activation</a></li><li><a class="tocitem" href="../ARG2000_example/">ARG2000 activation example</a></li><li><a class="tocitem" href="../IceNucleation/">Ice Nucleation</a></li><li class="is-active"><a class="tocitem" href>Box model ice nucleation example</a><ul class="internal"><li><a class="tocitem" href="#Equations"><span>Equations</span></a></li><li><a class="tocitem" href="#Water-vapour-deposition-on-dust"><span>Water vapour deposition on dust</span></a></li><li><a class="tocitem" href="#Example-figures"><span>Example figures</span></a></li></ul></li><li><a class="tocitem" href="../AerosolNucleation/">Aerosol Nucleation</a></li><li><a class="tocitem" href="../PrecipitationSusceptibility/">Precipitation Susceptibility</a></li><li><a class="tocitem" href="../API/">API</a></li><li><a class="tocitem" href="../References/">References</a></li><li><a class="tocitem" href="../DevelopersGuide/">Developer&#39;s Guide</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Box model ice nucleation example</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Box model ice nucleation example</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/CliMA/CloudMicrophysics.jl/blob/main/docs/src/IceNucleationBox.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="dimensional-ice-nucleation-model"><a class="docs-heading-anchor" href="#dimensional-ice-nucleation-model">0-dimensional ice nucleation model</a><a id="dimensional-ice-nucleation-model-1"></a><a class="docs-heading-anchor-permalink" href="#dimensional-ice-nucleation-model" title="Permalink"></a></h1><h2 id="Equations"><a class="docs-heading-anchor" href="#Equations">Equations</a><a id="Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Equations" title="Permalink"></a></h2><p>This is a 0-dimensional adiabatic parcel model for testing nucleation schemes. It is based on <a href="../References/#KorolevMazin2003">[39]</a>, as well as the cirrus box model   <a href="../References/#Karcher2006">[40]</a>, <a href="../References/#Tully2023">[41]</a>. The model solves for saturation in a 0-dimensional   adiabatic parcel raising with constant velocity.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>For now, the equations are written assuming that only the water vapor and cloud ice are present in the system.</p></div></div><p>We define ice saturation ratio <span>$S_i$</span></p><p class="math-container">\[\begin{equation}
S_i = \frac{e}{e_{si}}
\end{equation}\]</p><p>where:</p><ul><li><span>$e$</span> - is the partial pressure of water vapor,</li><li><span>$e_{si}$</span> - is the partial pressure of water vapor at saturation over ice.</li></ul><p>The change in saturation can be described as</p><p class="math-container">\[\begin{equation}
\frac{dS_i}{dt} = \frac{1}{e_{si}} \frac{de}{dt} - \frac{e}{e_{si}^2} \frac{de_{si}}{dt}
\end{equation}\]</p><p>From ideal gas law the partial pressure of water vapor can be written as</p><p class="math-container">\[\begin{equation}
e = q_v p \frac{R_v}{R_a}
\end{equation}\]</p><p>where:</p><ul><li><span>$q_v$</span> is the water vapor specific humidity</li><li><span>$p$</span> is the air pressure</li><li><span>$R_v$</span>, <span>$R_a$</span> are the gas constants for water vapor and air.</li></ul><p>The change in partial pressure can be written as</p><p class="math-container">\[\begin{equation}
\frac{de}{dt} = \frac{dq_v}{dt} p \frac{R_v}{R_a} + q_v \frac{dp}{dt}\frac{R_v}{R_a}
\end{equation}\]</p><p>From the Clausius–Clapeyron relation</p><p class="math-container">\[\begin{equation}
\frac{de_{si}}{dt} = \frac{L_s e_{si}}{R_v T^2} \frac{dT}{dt}
\end{equation}\]</p><p>where:</p><ul><li><span>$L_s$</span> is the latent heat of sublimation</li><li><span>$T$</span> is the temperature.</li></ul><p>From the moist adiabatic assumption</p><p class="math-container">\[\begin{equation}
\frac{dT}{dt} = \frac{R_a T}{c_p p} \frac{dp}{dt} + \frac{L_w}{c_p} \frac{dq_l}{dt} + \frac{L_s}{c_p} \frac{d q_i}{dt}
\end{equation}\]</p><p>where:</p><ul><li><span>$L_w$</span> is the latent heat of evaporation.</li></ul><p>From hydrostatic balance and assuming constant vertical velocity:</p><p class="math-container">\[\begin{equation}
\frac{dp}{dt} = -\frac{p g}{R_a T} w
\end{equation}\]</p><p>where:</p><ul><li><span>$g$</span> is the gravitational acceleration</li><li><span>$w$</span> is the constant vertical velocity.</li></ul><p>Assuming only water vapor and ice are present <span>$q_l = 0$</span>, <span>$\frac{dq_v}{dt} = -\frac{dq_i}{dt}$</span>, and rearranging the terms</p><p class="math-container">\[\begin{equation}
\frac{dS_i}{dt} = a_1 w S_i - \left(a_2 + a_3 S_i\right) \frac{dq_i}{dt}
\end{equation}\]</p><p>where:</p><p class="math-container">\[\begin{equation}
a_1 = \frac{L_s g}{c_p T^2 R_v} - \frac{g}{R_a T}
\end{equation}\]</p><p class="math-container">\[\begin{equation}
a_2 = \frac{p}{e_{si}} \frac{R_v}{R_a}
\end{equation}\]</p><p class="math-container">\[\begin{equation}
a_3 = \frac{L_s^2}{R_v T^2 c_p}
\end{equation}\]</p><p>The crux of the problem is modeling the <span>$\frac{dq_i}{dt}$</span> for different homogeneous and heterogeneous ice nucleation paths. For now we only consider the water vapor deposition on dust particles.</p><h2 id="Water-vapour-deposition-on-dust"><a class="docs-heading-anchor" href="#Water-vapour-deposition-on-dust">Water vapour deposition on dust</a><a id="Water-vapour-deposition-on-dust-1"></a><a class="docs-heading-anchor-permalink" href="#Water-vapour-deposition-on-dust" title="Permalink"></a></h2><p>For the simplest case of a spherical ice particle growing through water vapor deposition (<a href="https://clima.github.io/CloudMicrophysics.jl/previews/PR103/Microphysics1M/#Snow-autoconversion">see discussion</a>), the change of it&#39;s mass is defined as</p><p class="math-container">\[\begin{equation}
  \frac{dm}{dt} = 4 \pi \, r \, \alpha_m \, (S_i - 1) \, G(T)
  \label{eq:massratesphere}
\end{equation}\]</p><p>where:</p><ul><li><span>$r$</span> is the particle radius,</li><li><span>$\alpha_m$</span> is the accommodation coefficient that takes into account the fact that not all water vapor molecules   that arrive at the particle surface will join the growing crystal,</li><li><span>$G(T) = \left(\frac{L_s}{KT} \left(\frac{L_s}{R_v T} - 1 \right) + \frac{R_v T}{e_{si} D} \right)^{-1}$</span>   combines the effects of thermal conductivity and water diffusivity,</li><li><span>$K$</span> is the thermal conductivity of air,</li><li><span>$D$</span> is the diffusivity of water vapor.</li></ul><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The <span>$r$</span> in eq. (\ref{eq:massratesphere}) should be replaced by the capacitance <span>$C$</span>, when considering non-spherical particles. For a sphere <span>$C=r$</span>, for a circular disc <span>$C=2r/\pi$</span>.</p></div></div><p>The rate of change of ice specific humidity <span>$q_i$</span> can be computed as</p><p class="math-container">\[\begin{equation}
  \frac{d \, q_i}{dt} =
  \frac{1}{\rho} \int_{0}^{\infty} \frac{dm}{dt} n(r) dr
  \label{eq:qi_rat}
\end{equation}\]</p><p>Assuming that the size distribution of nucleated and growing ice crystals is a delta function</p><p class="math-container">\[\begin{equation}
n(r) = N_{act} \delta(r-r_0)
\end{equation}\]</p><p>eq. (\ref{eq:qi_rat}) can be written as</p><p class="math-container">\[\begin{equation}
  \frac{d \, q_i}{dt} =
  \frac{1}{\rho} N_{act} \alpha_m 4 \pi \, r_0 \, (S_i - 1) \, G(T)
\end{equation}\]</p><p>where <span>$N_{act}$</span> is the number of activated ice particles.</p><p><span>$N_{act}$</span> can be computed from <a href="https://clima.github.io/CloudMicrophysics.jl/previews/PR103/IceNucleation/#Activated-fraction-for-deposition-freezing-on-dust">activated fraction</a> <span>$f_i$</span></p><p class="math-container">\[\begin{equation}
  N_{act} = N_{tot} * f_i
\end{equation}\]</p><h2 id="Example-figures"><a class="docs-heading-anchor" href="#Example-figures">Example figures</a><a id="Example-figures-1"></a><a class="docs-heading-anchor-permalink" href="#Example-figures" title="Permalink"></a></h2><p>Here we show example simulation results from the adiabatic parcel model. The model is run three times for 30 minutes simulation time,   (shown by three different colors on the plot). Between each run the water vapor specific humidity is changed,   while keeping all other state variables the same as at the last time step   of the previous run. The prescribed vertical velocity is equal to 3.5 cm/s.</p><pre><code class="language-julia hljs">include(&quot;../../parcel/Tully_et_al_2023.jl&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">CairoMakie.Screen{SVG}
</code></pre><p><img src="../cirrus_box.svg" alt/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../IceNucleation/">« Ice Nucleation</a><a class="docs-footer-nextpage" href="../AerosolNucleation/">Aerosol Nucleation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Saturday 2 September 2023 06:57">Saturday 2 September 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
