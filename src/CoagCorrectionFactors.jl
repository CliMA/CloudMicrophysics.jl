module CoagCorrectionFactors

export intramodal_correction

"""
intramodal_correction(stdev)
Given the geometric standard deviation of an aerosol mode,
returns the correction factor for the intramodal coagulation integral
Correction factors for 0-th and 6-th moment are the same in Whitby 91 - see p. H.8
These correction factors are obtained from the CAM5 code for higher precision.
"""
function intramodal_correction(stdev)
    index = max(1, min(10, 
                round(Integer, (stdev - 0.75) / 0.25)))
    correction_factors = 
    [0.707106785165097, 0.726148960080488, 0.766430744110958,
    0.814106389441342, 0.861679526483207, 0.903600509090092,   
    0.936578814219156, 0.960098926735545, 0.975646823342881,   
    0.985397173215326]
    return correction_factors[index]
end

function getindex(R_2, stdev_ait, stdev_acc)
    i_R_2 = max(1, min(10, 
                1+round(Integer, (log(R_2) / log(sqrt(2))))))
    i_stdev_ait = max(1, min(10, 
                    round(Integer, (stdev_ait - 0.75) / 0.25)))
    i_stdev_acc = max(1, min(10, 
                    round(Integer, (stdev_acc - 0.75) / 0.25)))
    return i_R_2, i_stdev_ait, i_stdev_acc
end

function intermodal_m0_correction(R_2, stdev_ait, stdev_acc)
    (i_R_2, i_stdev_ait, i_stdev_acc) = getindex(R_2, stdev_ait, stdev_acc)
    correction_factors = 
    [[[0.628539,  0.639610,  0.664514,  0.696278,  0.731558,   
    0.768211,  0.804480,  0.838830,  0.870024,  0.897248],
    [0.639178,  0.649966,  0.674432,  0.705794,  0.740642,   
    0.776751,  0.812323,  0.845827,  0.876076,  0.902324],
    [0.663109,  0.673464,  0.697147,  0.727637,  0.761425,   
    0.796155,  0.829978,  0.861419,  0.889424,  0.913417],
    [0.693693,  0.703654,  0.726478,  0.755786,  0.787980,   
    0.820626,  0.851898,  0.880459,  0.905465,  0.926552],
    [0.727803,  0.737349,  0.759140,  0.786870,  0.816901,   
    0.846813,  0.874906,  0.900060,  0.921679,  0.939614],
    [0.763461,  0.772483,  0.792930,  0.818599,  0.845905,   
    0.872550,  0.897051,  0.918552,  0.936701,  0.951528],
    [0.799021,  0.807365,  0.826094,  0.849230,  0.873358,   
    0.896406,  0.917161,  0.935031,  0.949868,  0.961828],
    [0.833004,  0.840514,  0.857192,  0.877446,  0.898147,   
    0.917518,  0.934627,  0.949106,  0.960958,  0.970403],
    [0.864172,  0.870734,  0.885153,  0.902373,  0.919640,   
    0.935494,  0.949257,  0.960733,  0.970016,  0.977346],
    [0.891658,  0.897227,  0.909343,  0.923588,  0.937629,   
    0.950307,  0.961151,  0.970082,  0.977236,  0.982844]],
    [[0.658724,  0.670587,  0.697539,  0.731890,  0.769467,   
    0.807391,  0.843410,  0.875847,  0.903700,  0.926645],
    [0.667070,  0.678820,  0.705538,  0.739591,  0.776758,   
    0.814118,  0.849415,  0.881020,  0.908006,  0.930121],
    [0.686356,  0.697839,  0.723997,  0.757285,  0.793389,   
    0.829313,  0.862835,  0.892459,  0.917432,  0.937663],
    [0.711425,  0.722572,  0.747941,  0.780055,  0.814518,   
    0.848315,  0.879335,  0.906290,  0.928658,  0.946526],
    [0.739575,  0.750307,  0.774633,  0.805138,  0.837408,   
    0.868504,  0.896517,  0.920421,  0.939932,  0.955299],
    [0.769143,  0.779346,  0.802314,  0.830752,  0.860333,   
    0.888300,  0.913014,  0.933727,  0.950370,  0.963306],
    [0.798900,  0.808431,  0.829700,  0.855653,  0.882163,   
    0.906749,  0.928075,  0.945654,  0.959579,  0.970280],
    [0.827826,  0.836542,  0.855808,  0.878954,  0.902174,   
    0.923316,  0.941345,  0.955989,  0.967450,  0.976174],
    [0.855068,  0.862856,  0.879900,  0.900068,  0.919956,   
    0.937764,  0.952725,  0.964726,  0.974027,  0.981053],
    [0.879961,  0.886755,  0.901484,  0.918665,  0.935346,   
    0.950065,  0.962277,  0.971974,  0.979432,  0.985033]],
    [[0.724166,  0.735474,  0.761359,  0.794045,  0.828702,   
    0.862061,  0.891995,  0.917385,  0.937959,  0.954036],
    [0.730416,  0.741780,  0.767647,  0.800116,  0.834344,   
    0.867093,  0.896302,  0.920934,  0.940790,  0.956237],
    [0.745327,  0.756664,  0.782255,  0.814026,  0.847107,   
    0.878339,  0.905820,  0.928699,  0.946931,  0.960977],
    [0.765195,  0.776312,  0.801216,  0.831758,  0.863079,   
    0.892159,  0.917319,  0.937939,  0.954145,  0.966486],
    [0.787632,  0.798347,  0.822165,  0.850985,  0.880049,   
    0.906544,  0.929062,  0.947218,  0.961288,  0.971878],
    [0.811024,  0.821179,  0.843557,  0.870247,  0.896694,   
    0.920365,  0.940131,  0.955821,  0.967820,  0.976753],
    [0.834254,  0.843709,  0.864356,  0.888619,  0.912245,   
    0.933019,  0.950084,  0.963438,  0.973530,  0.980973],
    [0.856531,  0.865176,  0.883881,  0.905544,  0.926290,   
    0.944236,  0.958762,  0.969988,  0.978386,  0.984530],
    [0.877307,  0.885070,  0.901716,  0.920729,  0.938663,   
    0.953951,  0.966169,  0.975512,  0.982442,  0.987477],
    [0.896234,  0.903082,  0.917645,  0.934069,  0.949354,   
    0.962222,  0.972396,  0.980107,  0.985788,  0.989894]],
    [[0.799294,  0.809144,  0.831293,  0.858395,  0.885897,   
    0.911031,  0.932406,  0.949642,  0.963001,  0.973062],
    [0.804239,  0.814102,  0.836169,  0.862984,  0.890003,   
    0.914535,  0.935274,  0.951910,  0.964748,  0.974381],
    [0.815910,  0.825708,  0.847403,  0.873389,  0.899185,   
    0.922275,  0.941543,  0.956826,  0.968507,  0.977204],
    [0.831348,  0.840892,  0.861793,  0.886428,  0.910463,   
    0.931614,  0.948993,  0.962593,  0.972872,  0.980456],
    [0.848597,  0.857693,  0.877402,  0.900265,  0.922180,   
    0.941134,  0.956464,  0.968298,  0.977143,  0.983611],
    [0.866271,  0.874764,  0.892984,  0.913796,  0.933407,   
    0.950088,  0.963380,  0.973512,  0.981006,  0.986440],
    [0.883430,  0.891216,  0.907762,  0.926388,  0.943660,   
    0.958127,  0.969499,  0.978070,  0.984351,  0.988872],
    [0.899483,  0.906505,  0.921294,  0.937719,  0.952729,   
    0.965131,  0.974762,  0.981950,  0.987175,  0.990912],
    [0.914096,  0.920337,  0.933373,  0.947677,  0.960579,   
    0.971111,  0.979206,  0.985196,  0.989520,  0.992597],
    [0.927122,  0.932597,  0.943952,  0.956277,  0.967268,   
    0.976147,  0.982912,  0.987882,  0.991450,  0.993976]],
    [[0.865049,  0.872851,  0.889900,  0.909907,  0.929290,   
    0.946205,  0.959991,  0.970706,  0.978764,  0.984692],
    [0.868989,  0.876713,  0.893538,  0.913173,  0.932080,   
    0.948484,  0.961785,  0.972080,  0.979796,  0.985457],
    [0.878010,  0.885524,  0.901756,  0.920464,  0.938235,   
    0.953461,  0.965672,  0.975037,  0.982005,  0.987085],
    [0.889534,  0.896698,  0.912012,  0.929395,  0.945647,   
    0.959366,  0.970227,  0.978469,  0.984547,  0.988950],
    [0.902033,  0.908713,  0.922848,  0.938648,  0.953186,   
    0.965278,  0.974729,  0.981824,  0.987013,  0.990746],
    [0.914496,  0.920599,  0.933389,  0.947485,  0.960262,   
    0.970743,  0.978839,  0.984858,  0.989225,  0.992348],
    [0.926281,  0.931761,  0.943142,  0.955526,  0.966600,   
    0.975573,  0.982431,  0.987485,  0.991128,  0.993718],
    [0.937029,  0.941877,  0.951868,  0.962615,  0.972112,   
    0.979723,  0.985488,  0.989705,  0.992725,  0.994863],
    [0.946580,  0.950819,  0.959494,  0.968732,  0.976811,   
    0.983226,  0.988047,  0.991550,  0.994047,  0.995806],
    [0.954909,  0.958581,  0.966049,  0.973933,  0.980766,   
    0.986149,  0.990166,  0.993070,  0.995130,  0.996577]],
    [[0.914182,  0.919824,  0.931832,  0.945387,  0.957999,   
    0.968606,  0.976982,  0.983331,  0.988013,  0.991407],
    [0.917139,  0.922665,  0.934395,  0.947580,  0.959792,   
    0.970017,  0.978062,  0.984138,  0.988609,  0.991843],
    [0.923742,  0.928990,  0.940064,  0.952396,  0.963699,   
    0.973070,  0.980381,  0.985866,  0.989878,  0.992768],
    [0.931870,  0.936743,  0.946941,  0.958162,  0.968318,   
    0.976640,  0.983069,  0.987853,  0.991330,  0.993822],
    [0.940376,  0.944807,  0.954004,  0.963999,  0.972928,   
    0.980162,  0.985695,  0.989779,  0.992729,  0.994833],
    [0.948597,  0.952555,  0.960703,  0.969454,  0.977181,   
    0.983373,  0.988067,  0.991507,  0.993977,  0.995730],
    [0.956167,  0.959648,  0.966763,  0.974326,  0.980933,   
    0.986177,  0.990121,  0.992993,  0.995045,  0.996495],
    [0.962913,  0.965937,  0.972080,  0.978552,  0.984153,   
    0.988563,  0.991857,  0.994242,  0.995938,  0.997133],
    [0.968787,  0.971391,  0.976651,  0.982148,  0.986869,   
    0.990560,  0.993301,  0.995275,  0.996675,  0.997657],
    [0.973822,  0.976047,  0.980523,  0.985170,  0.989134,   
    0.992215,  0.994491,  0.996124,  0.997277,  0.998085]],
    [[0.947410,  0.951207,  0.959119,  0.967781,  0.975592,   
    0.981981,  0.986915,  0.990590,  0.993266,  0.995187],
    [0.949477,  0.953161,  0.960824,  0.969187,  0.976702,   
    0.982831,  0.987550,  0.991057,  0.993606,  0.995434],
    [0.954008,  0.957438,  0.964537,  0.972232,  0.979095,   
    0.984653,  0.988907,  0.992053,  0.994330,  0.995958],
    [0.959431,  0.962539,  0.968935,  0.975808,  0.981882,   
    0.986759,  0.990466,  0.993190,  0.995153,  0.996552],
    [0.964932,  0.967693,  0.973342,  0.979355,  0.984620,   
    0.988812,  0.991974,  0.994285,  0.995943,  0.997119],
    [0.970101,  0.972517,  0.977428,  0.982612,  0.987110,   
    0.990663,  0.993326,  0.995261,  0.996644,  0.997621],
    [0.974746,  0.976834,  0.981055,  0.985475,  0.989280,   
    0.992265,  0.994488,  0.996097,  0.997241,  0.998048],
    [0.978804,  0.980591,  0.984187,  0.987927,  0.991124,   
    0.993617,  0.995464,  0.996795,  0.997739,  0.998403],
    [0.982280,  0.983799,  0.986844,  0.989991,  0.992667,   
    0.994742,  0.996273,  0.997372,  0.998149,  0.998695],
    [0.985218,  0.986503,  0.989071,  0.991711,  0.993945,   
    0.995669,  0.996937,  0.997844,  0.998484,  0.998932]],
    [[0.968507,  0.970935,  0.975916,  0.981248,  0.985947,   
    0.989716,  0.992580,  0.994689,  0.996210,  0.997297],
    [0.969870,  0.972210,  0.977002,  0.982119,  0.986619,   
    0.990219,  0.992951,  0.994958,  0.996405,  0.997437],
    [0.972820,  0.974963,  0.979339,  0.983988,  0.988054,   
    0.991292,  0.993738,  0.995529,  0.996817,  0.997734],
    [0.976280,  0.978186,  0.982060,  0.986151,  0.989706,   
    0.992520,  0.994636,  0.996179,  0.997284,  0.998069],
    [0.979711,  0.981372,  0.984735,  0.988263,  0.991309,   
    0.993706,  0.995499,  0.996801,  0.997730,  0.998389],
    [0.982863,  0.984292,  0.987172,  0.990174,  0.992750,   
    0.994766,  0.996266,  0.997352,  0.998125,  0.998670],
    [0.985642,  0.986858,  0.989301,  0.991834,  0.993994,   
    0.995676,  0.996923,  0.997822,  0.998460,  0.998910],
    [0.988029,  0.989058,  0.991116,  0.993240,  0.995043,   
    0.996440,  0.997472,  0.998214,  0.998739,  0.999108],
    [0.990046,  0.990912,  0.992640,  0.994415,  0.995914,   
    0.997073,  0.997925,  0.998536,  0.998968,  0.999271],
    [0.991732,  0.992459,  0.993906,  0.995386,  0.996633,   
    0.997592,  0.998296,  0.998799,  0.999154,  0.999403]],
    [[0.981392,  0.982893,  0.985938,  0.989146,  0.991928,   
    0.994129,  0.995783,  0.996991,  0.997857,  0.998473],
    [0.982254,  0.983693,  0.986608,  0.989673,  0.992328,   
    0.994424,  0.995998,  0.997146,  0.997969,  0.998553],
    [0.984104,  0.985407,  0.988040,  0.990798,  0.993178,   
    0.995052,  0.996454,  0.997474,  0.998204,  0.998722],
    [0.986243,  0.987386,  0.989687,  0.992087,  0.994149,   
    0.995765,  0.996971,  0.997846,  0.998470,  0.998913],
    [0.988332,  0.989313,  0.991284,  0.993332,  0.995082,   
    0.996449,  0.997465,  0.998200,  0.998723,  0.999093],
    [0.990220,  0.991053,  0.992721,  0.994445,  0.995914,   
    0.997056,  0.997902,  0.998513,  0.998947,  0.999253],
    [0.991859,  0.992561,  0.993961,  0.995403,  0.996626,   
    0.997574,  0.998274,  0.998778,  0.999136,  0.999387],
    [0.993250,  0.993837,  0.995007,  0.996208,  0.997223,   
    0.998007,  0.998584,  0.998999,  0.999293,  0.999499],
    [0.994413,  0.994903,  0.995878,  0.996876,  0.997716,   
    0.998363,  0.998839,  0.999180,  0.999421,  0.999591],
    [0.995376,  0.995785,  0.996597,  0.997425,  0.998121,   
    0.998655,  0.999048,  0.999328,  0.999526,  0.999665]],
    [[0.989082,  0.989991,  0.991819,  0.993723,  0.995357,   
    0.996637,  0.997592,  0.998286,  0.998781,  0.999132],
    [0.989613,  0.990480,  0.992224,  0.994039,  0.995594,   
    0.996810,  0.997717,  0.998375,  0.998845,  0.999178],
    [0.990744,  0.991523,  0.993086,  0.994708,  0.996094,   
    0.997176,  0.997981,  0.998564,  0.998980,  0.999274],
    [0.992041,  0.992716,  0.994070,  0.995470,  0.996662,   
    0.997591,  0.998280,  0.998778,  0.999133,  0.999383],
    [0.993292,  0.993867,  0.995015,  0.996199,  0.997205,   
    0.997985,  0.998564,  0.998981,  0.999277,  0.999487],
    [0.994411,  0.994894,  0.995857,  0.996847,  0.997685,   
    0.998334,  0.998814,  0.999159,  0.999404,  0.999577],
    [0.995373,  0.995776,  0.996577,  0.997400,  0.998094,   
    0.998630,  0.999026,  0.999310,  0.999512,  0.999654],
    [0.996181,  0.996516,  0.997181,  0.997861,  0.998435,   
    0.998877,  0.999202,  0.999435,  0.999601,  0.999717],
    [0.996851,  0.997128,  0.997680,  0.998242,  0.998715,   
    0.999079,  0.999346,  0.999538,  0.999673,  0.999769],
    [0.997402,  0.997632,  0.998089,  0.998554,  0.998945,   
    0.999244,  0.999464,  0.999622,  0.999733,  0.999811]]]
    return correction_factors[i_R][i_stdev_ait][i_stdev_acc]
end

function intermodal_m3_correction(R_2, stdev_ait, stdev_acc)
    (i_R_2, i_stdev_ait, i_stdev_acc) = getindex(R_2, stdev_ait, stdev_acc)
    correction_factors = 
    [[[0.70708_r8,0.71681_r8,0.73821_r8,0.76477_r8,0.79350_r8,
    0.82265_r8,0.85090_r8,0.87717_r8,0.90069_r8,0.92097_r8],
    [0.72172_r8,0.73022_r8,0.74927_r8,0.77324_r8,0.79936_r8,
    0.82601_r8,0.85199_r8,0.87637_r8,0.89843_r8,0.91774_r8],
    [0.78291_r8,0.78896_r8,0.80286_r8,0.82070_r8,0.84022_r8,
    0.85997_r8,0.87901_r8,0.89669_r8,0.91258_r8,0.92647_r8],
    [0.87760_r8,0.88147_r8,0.89025_r8,0.90127_r8,0.91291_r8,
    0.92420_r8,0.93452_r8,0.94355_r8,0.95113_r8,0.95726_r8],
    [0.94988_r8,0.95184_r8,0.95612_r8,0.96122_r8,0.96628_r8,
    0.97085_r8,0.97467_r8,0.97763_r8,0.97971_r8,0.98089_r8],
    [0.98318_r8,0.98393_r8,0.98551_r8,0.98728_r8,0.98889_r8,
    0.99014_r8,0.99095_r8,0.99124_r8,0.99100_r8,0.99020_r8],
    [0.99480_r8,0.99504_r8,0.99551_r8,0.99598_r8,0.99629_r8,
    0.99635_r8,0.99611_r8,0.99550_r8,0.99450_r8,0.99306_r8],
    [0.99842_r8,0.99848_r8,0.99858_r8,0.99861_r8,0.99850_r8,
    0.99819_r8,0.99762_r8,0.99674_r8,0.99550_r8,0.99388_r8],
    [0.99951_r8,0.99951_r8,0.99949_r8,0.99939_r8,0.99915_r8,
    0.99872_r8,0.99805_r8,0.99709_r8,0.99579_r8,0.99411_r8],
    [0.99984_r8,0.99982_r8,0.99976_r8,0.99962_r8,0.99934_r8,
    0.99888_r8,0.99818_r8,0.99719_r8,0.99587_r8,0.99417_r8]],
    [[0.72957_r8,0.73993_r8,0.76303_r8,0.79178_r8,0.82245_r8,
    0.85270_r8,0.88085_r8,0.90578_r8,0.92691_r8,0.94415_r8],
    [0.72319_r8,0.73320_r8,0.75547_r8,0.78323_r8,0.81307_r8,
    0.84287_r8,0.87107_r8,0.89651_r8,0.91852_r8,0.93683_r8],
    [0.74413_r8,0.75205_r8,0.76998_r8,0.79269_r8,0.81746_r8,
    0.84258_r8,0.86685_r8,0.88938_r8,0.90953_r8,0.92695_r8],
    [0.82588_r8,0.83113_r8,0.84309_r8,0.85825_r8,0.87456_r8,
    0.89072_r8,0.90594_r8,0.91972_r8,0.93178_r8,0.94203_r8],
    [0.91886_r8,0.92179_r8,0.92831_r8,0.93624_r8,0.94434_r8,
    0.95192_r8,0.95856_r8,0.96409_r8,0.96845_r8,0.97164_r8],
    [0.97129_r8,0.97252_r8,0.97515_r8,0.97818_r8,0.98108_r8,
    0.98354_r8,0.98542_r8,0.98665_r8,0.98721_r8,0.98709_r8],
    [0.99104_r8,0.99145_r8,0.99230_r8,0.99320_r8,0.99394_r8,
    0.99439_r8,0.99448_r8,0.99416_r8,0.99340_r8,0.99217_r8],
    [0.99730_r8,0.99741_r8,0.99763_r8,0.99779_r8,0.99782_r8,
    0.99762_r8,0.99715_r8,0.99636_r8,0.99519_r8,0.99363_r8],
    [0.99917_r8,0.99919_r8,0.99921_r8,0.99915_r8,0.99895_r8,
    0.99856_r8,0.99792_r8,0.99698_r8,0.99570_r8,0.99404_r8],
    [0.99973_r8,0.99973_r8,0.99968_r8,0.99955_r8,0.99928_r8,
    0.99883_r8,0.99814_r8,0.99716_r8,0.99584_r8,0.99415_r8]],
    [[0.78358_r8,0.79304_r8,0.81445_r8,0.84105_r8,0.86873_r8,
    0.89491_r8,0.91805_r8,0.93743_r8,0.95300_r8,0.96510_r8],
    [0.76412_r8,0.77404_r8,0.79635_r8,0.82404_r8,0.85312_r8,
    0.88101_r8,0.90610_r8,0.92751_r8,0.94500_r8,0.95879_r8],
    [0.74239_r8,0.75182_r8,0.77301_r8,0.79956_r8,0.82809_r8,
    0.85639_r8,0.88291_r8,0.90658_r8,0.92683_r8,0.94350_r8],
    [0.78072_r8,0.78758_r8,0.80317_r8,0.82293_r8,0.84437_r8,
    0.86589_r8,0.88643_r8,0.90526_r8,0.92194_r8,0.93625_r8],
    [0.87627_r8,0.88044_r8,0.88981_r8,0.90142_r8,0.91357_r8,
    0.92524_r8,0.93585_r8,0.94510_r8,0.95285_r8,0.95911_r8],
    [0.95176_r8,0.95371_r8,0.95796_r8,0.96297_r8,0.96792_r8,
    0.97233_r8,0.97599_r8,0.97880_r8,0.98072_r8,0.98178_r8],
    [0.98453_r8,0.98523_r8,0.98670_r8,0.98833_r8,0.98980_r8,
    0.99092_r8,0.99160_r8,0.99179_r8,0.99145_r8,0.99058_r8],
    [0.99534_r8,0.99555_r8,0.99597_r8,0.99637_r8,0.99662_r8,
    0.99663_r8,0.99633_r8,0.99569_r8,0.99465_r8,0.99318_r8],
    [0.99859_r8,0.99864_r8,0.99872_r8,0.99873_r8,0.99860_r8,
    0.99827_r8,0.99768_r8,0.99679_r8,0.99555_r8,0.99391_r8],
    [0.99956_r8,0.99956_r8,0.99953_r8,0.99942_r8,0.99918_r8,
    0.99875_r8,0.99807_r8,0.99711_r8,0.99580_r8,0.99412_r8]],
    [[0.84432_r8,0.85223_r8,0.86990_r8,0.89131_r8,0.91280_r8,
    0.93223_r8,0.94861_r8,0.96172_r8,0.97185_r8,0.97945_r8],
    [0.82299_r8,0.83164_r8,0.85101_r8,0.87463_r8,0.89857_r8,
    0.92050_r8,0.93923_r8,0.95443_r8,0.96629_r8,0.97529_r8],
    [0.77870_r8,0.78840_r8,0.81011_r8,0.83690_r8,0.86477_r8,
    0.89124_r8,0.91476_r8,0.93460_r8,0.95063_r8,0.96316_r8],
    [0.76386_r8,0.77233_r8,0.79147_r8,0.81557_r8,0.84149_r8,
    0.86719_r8,0.89126_r8,0.91275_r8,0.93116_r8,0.94637_r8],
    [0.82927_r8,0.83488_r8,0.84756_r8,0.86346_r8,0.88040_r8,
    0.89704_r8,0.91257_r8,0.92649_r8,0.93857_r8,0.94874_r8],
    [0.92184_r8,0.92481_r8,0.93136_r8,0.93925_r8,0.94724_r8,
    0.95462_r8,0.96104_r8,0.96634_r8,0.97048_r8,0.97348_r8],
    [0.97341_r8,0.97457_r8,0.97706_r8,0.97991_r8,0.98260_r8,
    0.98485_r8,0.98654_r8,0.98760_r8,0.98801_r8,0.98777_r8],
    [0.99192_r8,0.99229_r8,0.99305_r8,0.99385_r8,0.99449_r8,
    0.99486_r8,0.99487_r8,0.99449_r8,0.99367_r8,0.99239_r8],
    [0.99758_r8,0.99768_r8,0.99787_r8,0.99800_r8,0.99799_r8,
    0.99777_r8,0.99727_r8,0.99645_r8,0.99527_r8,0.99369_r8],
    [0.99926_r8,0.99928_r8,0.99928_r8,0.99921_r8,0.99900_r8,
    0.99860_r8,0.99795_r8,0.99701_r8,0.99572_r8,0.99405_r8]],
    [[0.89577_r8,0.90190_r8,0.91522_r8,0.93076_r8,0.94575_r8,
    0.95876_r8,0.96932_r8,0.97751_r8,0.98367_r8,0.98820_r8],
    [0.87860_r8,0.88547_r8,0.90052_r8,0.91828_r8,0.93557_r8,
    0.95075_r8,0.96319_r8,0.97292_r8,0.98028_r8,0.98572_r8],
    [0.83381_r8,0.84240_r8,0.86141_r8,0.88425_r8,0.90707_r8,
    0.92770_r8,0.94510_r8,0.95906_r8,0.96986_r8,0.97798_r8],
    [0.78530_r8,0.79463_r8,0.81550_r8,0.84127_r8,0.86813_r8,
    0.89367_r8,0.91642_r8,0.93566_r8,0.95125_r8,0.96347_r8],
    [0.79614_r8,0.80332_r8,0.81957_r8,0.84001_r8,0.86190_r8,
    0.88351_r8,0.90368_r8,0.92169_r8,0.93718_r8,0.95006_r8],
    [0.88192_r8,0.88617_r8,0.89565_r8,0.90728_r8,0.91931_r8,
    0.93076_r8,0.94107_r8,0.94997_r8,0.95739_r8,0.96333_r8],
    [0.95509_r8,0.95698_r8,0.96105_r8,0.96583_r8,0.97048_r8,
    0.97460_r8,0.97796_r8,0.98050_r8,0.98218_r8,0.98304_r8],
    [0.98596_r8,0.98660_r8,0.98794_r8,0.98943_r8,0.99074_r8,
    0.99172_r8,0.99227_r8,0.99235_r8,0.99192_r8,0.99096_r8],
    [0.99581_r8,0.99600_r8,0.99637_r8,0.99672_r8,0.99691_r8,
    0.99687_r8,0.99653_r8,0.99585_r8,0.99478_r8,0.99329_r8],
    [0.99873_r8,0.99878_r8,0.99884_r8,0.99883_r8,0.99869_r8,
    0.99834_r8,0.99774_r8,0.99684_r8,0.99558_r8,0.99394_r8]],
    [[0.93335_r8,0.93777_r8,0.94711_r8,0.95764_r8,0.96741_r8,
    0.97562_r8,0.98210_r8,0.98701_r8,0.99064_r8,0.99327_r8],
    [0.92142_r8,0.92646_r8,0.93723_r8,0.94947_r8,0.96096_r8,
    0.97069_r8,0.97842_r8,0.98431_r8,0.98868_r8,0.99186_r8],
    [0.88678_r8,0.89351_r8,0.90810_r8,0.92508_r8,0.94138_r8,
    0.95549_r8,0.96693_r8,0.97578_r8,0.98243_r8,0.98731_r8],
    [0.83249_r8,0.84124_r8,0.86051_r8,0.88357_r8,0.90655_r8,
    0.92728_r8,0.94477_r8,0.95880_r8,0.96964_r8,0.97779_r8],
    [0.79593_r8,0.80444_r8,0.82355_r8,0.84725_r8,0.87211_r8,
    0.89593_r8,0.91735_r8,0.93566_r8,0.95066_r8,0.96255_r8],
    [0.84124_r8,0.84695_r8,0.85980_r8,0.87575_r8,0.89256_r8,
    0.90885_r8,0.92383_r8,0.93704_r8,0.94830_r8,0.95761_r8],
    [0.92721_r8,0.93011_r8,0.93647_r8,0.94406_r8,0.95166_r8,
    0.95862_r8,0.96460_r8,0.96949_r8,0.97326_r8,0.97595_r8],
    [0.97573_r8,0.97681_r8,0.97913_r8,0.98175_r8,0.98421_r8,
    0.98624_r8,0.98772_r8,0.98860_r8,0.98885_r8,0.98847_r8],
    [0.99271_r8,0.99304_r8,0.99373_r8,0.99444_r8,0.99499_r8,
    0.99528_r8,0.99522_r8,0.99477_r8,0.99390_r8,0.99258_r8],
    [0.99782_r8,0.99791_r8,0.99807_r8,0.99817_r8,0.99813_r8,
    0.99788_r8,0.99737_r8,0.99653_r8,0.99533_r8,0.99374_r8]],
    [[0.95858_r8,0.96158_r8,0.96780_r8,0.97460_r8,0.98073_r8,
    0.98575_r8,0.98963_r8,0.99252_r8,0.99463_r8,0.99615_r8],
    [0.95091_r8,0.95438_r8,0.96163_r8,0.96962_r8,0.97688_r8,
    0.98286_r8,0.98751_r8,0.99099_r8,0.99353_r8,0.99536_r8],
    [0.92751_r8,0.93233_r8,0.94255_r8,0.95406_r8,0.96473_r8,
    0.97366_r8,0.98070_r8,0.98602_r8,0.98994_r8,0.99278_r8],
    [0.88371_r8,0.89075_r8,0.90595_r8,0.92351_r8,0.94028_r8,
    0.95474_r8,0.96642_r8,0.97544_r8,0.98220_r8,0.98715_r8],
    [0.82880_r8,0.83750_r8,0.85671_r8,0.87980_r8,0.90297_r8,
    0.92404_r8,0.94195_r8,0.95644_r8,0.96772_r8,0.97625_r8],
    [0.81933_r8,0.82655_r8,0.84279_r8,0.86295_r8,0.88412_r8,
    0.90449_r8,0.92295_r8,0.93890_r8,0.95215_r8,0.96281_r8],
    [0.89099_r8,0.89519_r8,0.90448_r8,0.91577_r8,0.92732_r8,
    0.93820_r8,0.94789_r8,0.95616_r8,0.96297_r8,0.96838_r8],
    [0.95886_r8,0.96064_r8,0.96448_r8,0.96894_r8,0.97324_r8,
    0.97701_r8,0.98004_r8,0.98228_r8,0.98371_r8,0.98435_r8],
    [0.98727_r8,0.98786_r8,0.98908_r8,0.99043_r8,0.99160_r8,
    0.99245_r8,0.99288_r8,0.99285_r8,0.99234_r8,0.99131_r8],
    [0.99621_r8,0.99638_r8,0.99671_r8,0.99700_r8,0.99715_r8,
    0.99707_r8,0.99670_r8,0.99599_r8,0.99489_r8,0.99338_r8]],
    [[0.97470_r8,0.97666_r8,0.98064_r8,0.98491_r8,0.98867_r8,
    0.99169_r8,0.99399_r8,0.99569_r8,0.99691_r8,0.99779_r8],
    [0.96996_r8,0.97225_r8,0.97693_r8,0.98196_r8,0.98643_r8,
    0.99003_r8,0.99279_r8,0.99482_r8,0.99630_r8,0.99735_r8],
    [0.95523_r8,0.95848_r8,0.96522_r8,0.97260_r8,0.97925_r8,
    0.98468_r8,0.98888_r8,0.99200_r8,0.99427_r8,0.99590_r8],
    [0.92524_r8,0.93030_r8,0.94098_r8,0.95294_r8,0.96397_r8,
    0.97317_r8,0.98038_r8,0.98582_r8,0.98981_r8,0.99270_r8],
    [0.87576_r8,0.88323_r8,0.89935_r8,0.91799_r8,0.93583_r8,
    0.95126_r8,0.96377_r8,0.97345_r8,0.98072_r8,0.98606_r8],
    [0.83078_r8,0.83894_r8,0.85705_r8,0.87899_r8,0.90126_r8,
    0.92179_r8,0.93950_r8,0.95404_r8,0.96551_r8,0.97430_r8],
    [0.85727_r8,0.86294_r8,0.87558_r8,0.89111_r8,0.90723_r8,
    0.92260_r8,0.93645_r8,0.94841_r8,0.95838_r8,0.96643_r8],
    [0.93337_r8,0.93615_r8,0.94220_r8,0.94937_r8,0.95647_r8,
    0.96292_r8,0.96840_r8,0.97283_r8,0.97619_r8,0.97854_r8],
    [0.97790_r8,0.97891_r8,0.98105_r8,0.98346_r8,0.98569_r8,
    0.98751_r8,0.98879_r8,0.98950_r8,0.98961_r8,0.98912_r8],
    [0.99337_r8,0.99367_r8,0.99430_r8,0.99493_r8,0.99541_r8,
    0.99562_r8,0.99551_r8,0.99501_r8,0.99410_r8,0.99274_r8]],
    [[0.98470_r8,0.98594_r8,0.98844_r8,0.99106_r8,0.99334_r8,
    0.99514_r8,0.99650_r8,0.99749_r8,0.99821_r8,0.99872_r8],
    [0.98184_r8,0.98330_r8,0.98624_r8,0.98934_r8,0.99205_r8,
    0.99420_r8,0.99582_r8,0.99701_r8,0.99787_r8,0.99848_r8],
    [0.97288_r8,0.97498_r8,0.97927_r8,0.98385_r8,0.98789_r8,
    0.99113_r8,0.99360_r8,0.99541_r8,0.99673_r8,0.99766_r8],
    [0.95403_r8,0.95741_r8,0.96440_r8,0.97202_r8,0.97887_r8,
    0.98444_r8,0.98872_r8,0.99190_r8,0.99421_r8,0.99586_r8],
    [0.91845_r8,0.92399_r8,0.93567_r8,0.94873_r8,0.96076_r8,
    0.97079_r8,0.97865_r8,0.98457_r8,0.98892_r8,0.99206_r8],
    [0.86762_r8,0.87533_r8,0.89202_r8,0.91148_r8,0.93027_r8,
    0.94669_r8,0.96013_r8,0.97062_r8,0.97855_r8,0.98441_r8],
    [0.84550_r8,0.85253_r8,0.86816_r8,0.88721_r8,0.90671_r8,
    0.92490_r8,0.94083_r8,0.95413_r8,0.96481_r8,0.97314_r8],
    [0.90138_r8,0.90544_r8,0.91437_r8,0.92513_r8,0.93602_r8,
    0.94615_r8,0.95506_r8,0.96258_r8,0.96868_r8,0.97347_r8],
    [0.96248_r8,0.96415_r8,0.96773_r8,0.97187_r8,0.97583_r8,
    0.97925_r8,0.98198_r8,0.98394_r8,0.98514_r8,0.98559_r8],
    [0.98837_r8,0.98892_r8,0.99005_r8,0.99127_r8,0.99232_r8,
    0.99306_r8,0.99339_r8,0.99328_r8,0.99269_r8,0.99161_r8]],
    [[0.99080_r8,0.99158_r8,0.99311_r8,0.99471_r8,0.99607_r8,
    0.99715_r8,0.99795_r8,0.99853_r8,0.99895_r8,0.99925_r8],
    [0.98910_r8,0.99001_r8,0.99182_r8,0.99371_r8,0.99533_r8,
    0.99661_r8,0.99757_r8,0.99826_r8,0.99876_r8,0.99912_r8],
    [0.98374_r8,0.98506_r8,0.98772_r8,0.99051_r8,0.99294_r8,
    0.99486_r8,0.99630_r8,0.99736_r8,0.99812_r8,0.99866_r8],
    [0.97238_r8,0.97453_r8,0.97892_r8,0.98361_r8,0.98773_r8,
    0.99104_r8,0.99354_r8,0.99538_r8,0.99671_r8,0.99765_r8],
    [0.94961_r8,0.95333_r8,0.96103_r8,0.96941_r8,0.97693_r8,
    0.98303_r8,0.98772_r8,0.99119_r8,0.99371_r8,0.99551_r8],
    [0.90943_r8,0.91550_r8,0.92834_r8,0.94275_r8,0.95608_r8,
    0.96723_r8,0.97600_r8,0.98263_r8,0.98751_r8,0.99103_r8],
    [0.86454_r8,0.87200_r8,0.88829_r8,0.90749_r8,0.92630_r8,
    0.94300_r8,0.95687_r8,0.96785_r8,0.97626_r8,0.98254_r8],
    [0.87498_r8,0.88048_r8,0.89264_r8,0.90737_r8,0.92240_r8,
    0.93642_r8,0.94877_r8,0.95917_r8,0.96762_r8,0.97429_r8],
    [0.93946_r8,0.94209_r8,0.94781_r8,0.95452_r8,0.96111_r8,
    0.96704_r8,0.97203_r8,0.97602_r8,0.97900_r8,0.98106_r8],
    [0.97977_r8,0.98071_r8,0.98270_r8,0.98492_r8,0.98695_r8,
    0.98858_r8,0.98970_r8,0.99027_r8,0.99026_r8,0.98968_r8]]]
    return correction_factors[i_R][i_stdev_ait][i_stdev_acc]
end 

end
