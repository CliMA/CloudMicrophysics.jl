<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Cloud diagnostics · CloudMicrophysics.jl</title><meta name="title" content="Cloud diagnostics · CloudMicrophysics.jl"/><meta property="og:title" content="Cloud diagnostics · CloudMicrophysics.jl"/><meta property="twitter:title" content="Cloud diagnostics · CloudMicrophysics.jl"/><meta name="description" content="Documentation for CloudMicrophysics.jl."/><meta property="og:description" content="Documentation for CloudMicrophysics.jl."/><meta property="twitter:description" content="Documentation for CloudMicrophysics.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="CloudMicrophysics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">CloudMicrophysics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2"><span class="docs-label">Parameterizations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../Microphysics0M/">0-moment precipitation microphysics</a></li><li><a class="tocitem" href="../Microphysics1M/">1-moment precipitation microphysics</a></li><li><a class="tocitem" href="../Microphysics2M/">2-moment precipitation microphysics</a></li><li><a class="tocitem" href="../P3Scheme/">P3 Scheme</a></li><li><a class="tocitem" href="../TerminalVelocity/">Terminal Velocity</a></li><li><a class="tocitem" href="../MicrophysicsNonEq/">Non-equilibrium cloud formation</a></li><li><a class="tocitem" href="../ThresholdsTransition/">Smooth transition at thresholds</a></li><li><a class="tocitem" href="../AerosolActivation/">Aerosol activation</a></li><li><a class="tocitem" href="../WaterActivity/">Water Activity</a></li><li><a class="tocitem" href="../IceNucleation/">Ice Nucleation</a></li><li><a class="tocitem" href="../AerosolNucleation/">Aerosol Nucleation</a></li><li class="is-active"><a class="tocitem" href>Cloud diagnostics</a><ul class="internal"><li><a class="tocitem" href="#Radar-reflectivity"><span>Radar reflectivity</span></a></li><li><a class="tocitem" href="#Effective-radius"><span>Effective radius</span></a></li><li><a class="tocitem" href="#Example-figures"><span>Example figures</span></a></li></ul></li><li><a class="tocitem" href="../PrecipitationSusceptibility/">Precipitation Susceptibility</a></li></ul></li><li><a class="tocitem" href="../Thermodynamics/">Thermodynamics interface</a></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">How to guides</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../guides/literated/GettingStarted/">Getting started</a></li><li><a class="tocitem" href="../guides/literated/Parameters/">Handling parameters</a></li><li><a class="tocitem" href="../guides/literated/SimpleModel/">Building a model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../IceNucleationParcel0D/">Adiabatic parcel model</a></li><li><a class="tocitem" href="../IceNucleationBox0D/">Box Model</a></li></ul></li><li><a class="tocitem" href="../API/">API</a></li><li><a class="tocitem" href="../DevelopersGuide/">Developer&#39;s Guide</a></li><li><a class="tocitem" href="../Glossary/">Glossary</a></li><li><a class="tocitem" href="../References/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Parameterizations</a></li><li class="is-active"><a href>Cloud diagnostics</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Cloud diagnostics</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CliMA/CloudMicrophysics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CliMA/CloudMicrophysics.jl/blob/main/docs/src/CloudDiagnostics.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Diagnostics"><a class="docs-heading-anchor" href="#Diagnostics">Diagnostics</a><a id="Diagnostics-1"></a><a class="docs-heading-anchor-permalink" href="#Diagnostics" title="Permalink"></a></h1><p><code>CloudMicrophysics.jl</code> offers a couple of options to compute cloud and precipitation radiative properties based on different available parameterizations and their underlying assumptions about the size distribution and properties of particles.</p><p>Available diagnostics are:</p><ul><li>Radar reflectivity</li><li>Effective radius</li></ul><p>Calculating these diagnostics make use of the physical moment equation for the generalized gamma distribution, as a function of particle mass. We denote the moment as <span>$M_x^n$</span> to emphasize that it is the moment with respect to the particle size distribution written as a function of particle mass <span>$x$</span>.</p><p class="math-container">\[\begin{equation}
M_x^n(;N, ν, μ, B)
  = ∫_0^∞ x^n ⋅ f(x) dx
  = N ⋅ B^{-\frac{n}{μ}} ⋅ \frac{Γ\left(\frac{ν+1+n}{μ}\right)}{Γ\left(\frac{ν+1}{μ}\right)}
\end{equation}\]</p><p>where:</p><p class="math-container">\[\begin{equation}
f(x) = A ⋅ x^ν ⋅ \exp(-B ⋅ x^μ)
\end{equation}\]</p><p>is the particle size distribution as a function of particle mass, and</p><p class="math-container">\[\begin{equation}
B = \left( \bar{x} \frac{Γ\left(\frac{ν+1}{μ}\right)}{Γ\left(\frac{ν+2}{μ}\right)} \right)^{-μ}
\end{equation}\]</p><p>is the particle size distribution parameter, in which <span>$\bar{x} = L/N$</span> is the mean particle mass. See the particle size distribution section in <a href="../Microphysics2M/#Microphysics-2M">Microphysics 2M</a> for more details.</p><h2 id="Radar-reflectivity"><a class="docs-heading-anchor" href="#Radar-reflectivity">Radar reflectivity</a><a id="Radar-reflectivity-1"></a><a class="docs-heading-anchor-permalink" href="#Radar-reflectivity" title="Permalink"></a></h2><p>The radar reflectivity factor <span>$Z$</span> is used to measure the power returned   by a radar signal when it encounters particles (cloud, rain droplets, etc),   and is defined as the sixth moment of the particles distributions <span>$n(r)$</span>:</p><p class="math-container">\[\begin{equation}
Z = {\int_0^\infty r^{6} \, n(r) \, dr}.
\label{eq:Z}
\end{equation}\]</p><p><span>$Z$</span> is typically normalized by radar reflectivity factor <span>$Z_0$</span> of a drop of radius <span>$1 mm$</span> in a volume of <span>$1 m^3$</span>, and is reported as a decimal logarithm to obtain the normalized logarithmic rain radar reflectivity <span>$L_Z$</span>.</p><p class="math-container">\[\begin{equation}
L_Z = {10 \, \log_{10} \left( \frac{Z}{Z_0} \right)}.
\end{equation}\]</p><p>The resulting logarithmic dimensionless unit is decibel relative to <span>$Z_0$</span>, or <span>$dBZ$</span>.</p><h3 id="1-moment-microphysics"><a class="docs-heading-anchor" href="#1-moment-microphysics">1-moment microphysics</a><a id="1-moment-microphysics-1"></a><a class="docs-heading-anchor-permalink" href="#1-moment-microphysics" title="Permalink"></a></h3><p>For the <a href="https://clima.github.io/CloudMicrophysics.jl/dev/Microphysics1M/">1-moment scheme</a>   we only consider the rain drop size distribution. Integrating over the assumed Marshall-Palmer distribution leads to</p><p class="math-container">\[\begin{equation}
Z = {\frac{6! \, n_{0}^{rai}}{\lambda^7}},
\end{equation}\]</p><p>where:</p><ul><li><span>$n_{0}^{rai}$</span> and <span>$\lambda$</span> - rain drop size distribution parameters.</li></ul><h3 id="2-moment-microphysics"><a class="docs-heading-anchor" href="#2-moment-microphysics">2-moment microphysics</a><a id="2-moment-microphysics-1"></a><a class="docs-heading-anchor-permalink" href="#2-moment-microphysics" title="Permalink"></a></h3><p>For the <a href="https://clima.github.io/CloudMicrophysics.jl/dev/Microphysics2M/">2-moment scheme</a>   we take into consideration the effect of both cloud and rain droplets. The radar reflectivity, as written above is proportional to the 2nd moment cloud number distribution in mass</p><p class="math-container">\[\begin{equation}
Z_c = M_x^2 / C^2
\end{equation}\]</p><p>where:</p><ul><li><span>$C = \frac{4}{3} π ρ_w$</span>.</li></ul><p>The additional factor of <span>$C^2$</span> results in a radar reflectivity that equals the 6th moment in radius.</p><p>Similar for rain drop exponential distribution</p><p class="math-container">\[\begin{equation}
Z_r = M_x^2 / C^2
\end{equation}\]</p><p>The final radar reflectivity factor is a sum of <span>$Z_c$</span> and <span>$Z_r$</span>.</p><h2 id="Effective-radius"><a class="docs-heading-anchor" href="#Effective-radius">Effective radius</a><a id="Effective-radius-1"></a><a class="docs-heading-anchor-permalink" href="#Effective-radius" title="Permalink"></a></h2><p>The effective radius of hydrometeors (<span>$r_\text{eff}$</span>) is defined as the area weighted radius of the population of particles. It can be computed as the ratio of the third to the second moment of the size distribution.</p><h3 id="2-moment-microphysics-2"><a class="docs-heading-anchor" href="#2-moment-microphysics-2">2-moment microphysics</a><a class="docs-heading-anchor-permalink" href="#2-moment-microphysics-2" title="Permalink"></a></h3><p>We compute the total third and second moment as a sum of cloud condensate and precipitation moments:</p><p class="math-container">\[\begin{equation}
r_{eff}
  = \frac{M^3_{r,c} + M^3_{r,r}}{M^2_{r,c} + M^2_{r,r}}
  = \frac{∫_0^∞ r^3 \, (n_c(r) + n_r(r)) \, dr}{∫_0^∞ r^2 \, (n_c(r) + n_r(r)) \, dr}.
\label{eq:reff}
\end{equation}\]</p><p>The 3rd moment in radius, <span>$M^3_r$</span> equals the 1st moment in mass, <span>$M^1_x$</span>,</p><p class="math-container">\[\begin{equation}
M^3_r = M^1_x / C
\end{equation}\]</p><p>where</p><ul><li><span>$C = \frac{4}{3} π ρ_w$</span> relates radius to mass for a spherical particle, <span>$x = C r^3$</span>.</li></ul><p>Similarly, the 2nd moment in radius, <span>$M^2_r$</span> equals the &quot;2/3rd&quot; moment in mass, <span>$M^2_x$</span>,</p><p class="math-container">\[\begin{equation}
M_r^2 = M_x^\frac{2}{3} / C^\frac{2}{3}
\end{equation}\]</p><h3 id="Liu-and-Hallett-1997"><a class="docs-heading-anchor" href="#Liu-and-Hallett-1997">Liu and Hallett 1997</a><a id="Liu-and-Hallett-1997-1"></a><a class="docs-heading-anchor-permalink" href="#Liu-and-Hallett-1997" title="Permalink"></a></h3><p>For 1-moment microphysics scheme the effective radius is parameterized following [<a href="../References/#Liu1997">57</a>]:</p><p class="math-container">\[\begin{equation}
  r_{eff} = \frac{r_{vol}}{k^{\frac{1}{3}}},
\end{equation}\]</p><p>where:</p><ul><li><span>$r_{vol}$</span> represents the volume-averaged radius,</li><li><span>$k = 0.8$</span>.</li></ul><p>Where the volume-averaged radius is computed using</p><p class="math-container">\[\begin{equation}
  r_{vol} = \left(\frac{3}{4 \pi \rho_w}\right)^{\frac{1}{3}} \, \left(\frac{L}{N}\right)^{\frac{1}{3}} = \left(\frac{3  \rho (q_{lcl} + q_{rai})}{4 \pi \rho_w (N_{lcl} + N_{rai})}\right)^{\frac{1}{3}},
\end{equation}\]</p><p>where:</p><ul><li><span>$L = \rho q$</span>, is the liquid water content (cloud water and rain),</li><li><span>$N = N_{lcl} + N_{rai}$</span>.</li></ul><p>By default for the 1-moment scheme we don&#39;t consider precipitation and assume a constant cloud droplet number concentration of 100 <span>$cm^{-3}$</span>.</p><h3 id="Constant"><a class="docs-heading-anchor" href="#Constant">Constant</a><a id="Constant-1"></a><a class="docs-heading-anchor-permalink" href="#Constant" title="Permalink"></a></h3><p>For testing purposes we also provide a constant effective radius option. The default values are 14 <span>$\mu m$</span> for liquid clouds and 25 <span>$\mu m$</span> for ice clouds, and can be easily overwritten via <code>ClimaParams.jl</code>.</p><h2 id="Example-figures"><a class="docs-heading-anchor" href="#Example-figures">Example figures</a><a id="Example-figures-1"></a><a class="docs-heading-anchor-permalink" href="#Example-figures" title="Permalink"></a></h2><p>Below we show effective radius and radar reflecivity plots as a function of cloud water and rain water. The effective radius is computed assuming a constant cloud droplet number concentration   of 100 or 1000 per cubic centimeter. The radar reflectivity is computed assuming a constant rain drop number concentration   of 10 or 100 per cubic centimeter. Note the effect of using the limiters in SB2006 scheme on the radar reflectivity.</p><pre><code class="language-julia hljs">include(&quot;plots/CloudDiagnostics.jl&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">CairoMakie.Screen{SVG}
</code></pre><p><img src="../CloudDiagnostics.svg" alt/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../AerosolNucleation/">« Aerosol Nucleation</a><a class="docs-footer-nextpage" href="../PrecipitationSusceptibility/">Precipitation Susceptibility »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Thursday 18 September 2025 00:46">Thursday 18 September 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
