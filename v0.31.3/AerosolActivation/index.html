<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Aerosol activation · CloudMicrophysics.jl</title><meta name="title" content="Aerosol activation · CloudMicrophysics.jl"/><meta property="og:title" content="Aerosol activation · CloudMicrophysics.jl"/><meta property="twitter:title" content="Aerosol activation · CloudMicrophysics.jl"/><meta name="description" content="Documentation for CloudMicrophysics.jl."/><meta property="og:description" content="Documentation for CloudMicrophysics.jl."/><meta property="twitter:description" content="Documentation for CloudMicrophysics.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="CloudMicrophysics.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">CloudMicrophysics.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2"><span class="docs-label">Parameterizations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../Microphysics0M/">0-moment precipitation microphysics</a></li><li><a class="tocitem" href="../Microphysics1M/">1-moment precipitation microphysics</a></li><li><a class="tocitem" href="../Microphysics2M/">2-moment precipitation microphysics</a></li><li><a class="tocitem" href="../P3Scheme/">P3 Scheme</a></li><li><a class="tocitem" href="../TerminalVelocity/">Terminal Velocity</a></li><li><a class="tocitem" href="../MicrophysicsNonEq/">Non-equilibrium cloud formation</a></li><li><a class="tocitem" href="../ThresholdsTransition/">Smooth transition at thresholds</a></li><li class="is-active"><a class="tocitem" href>Aerosol activation</a><ul class="internal"><li><a class="tocitem" href="#Assumed-aerosol-size-distribution-and-properties"><span>Assumed aerosol size distribution and properties</span></a></li><li><a class="tocitem" href="#Mean-Hygroscopicity"><span>Mean Hygroscopicity</span></a></li><li><a class="tocitem" href="#Critical-supersaturation"><span>Critical supersaturation</span></a></li><li><a class="tocitem" href="#Maximum-Supersaturation"><span>Maximum Supersaturation</span></a></li><li><a class="tocitem" href="#Number-and-mass-of-activated-particles"><span>Number and mass of activated particles</span></a></li><li><a class="tocitem" href="#Example-of-Aerosol-Activation-from-ARG2000"><span>Example of Aerosol Activation from ARG2000</span></a></li><li><a class="tocitem" href="#Aerosol-activation-prediction-with-ML-emulators-and-EKP-calibration"><span>Aerosol activation prediction with ML emulators and EKP calibration</span></a></li><li><a class="tocitem" href="#Modification-for-Local-Supersaturation-with-Preexisting-Hydrometeors"><span>Modification for Local Supersaturation with Preexisting Hydrometeors</span></a></li></ul></li><li><a class="tocitem" href="../WaterActivity/">Water Activity</a></li><li><a class="tocitem" href="../IceNucleation/">Ice Nucleation</a></li><li><a class="tocitem" href="../AerosolNucleation/">Aerosol Nucleation</a></li><li><a class="tocitem" href="../CloudDiagnostics/">Cloud diagnostics</a></li><li><a class="tocitem" href="../PrecipitationSusceptibility/">Precipitation Susceptibility</a></li></ul></li><li><a class="tocitem" href="../Thermodynamics/">Thermodynamics interface</a></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">How to guides</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../guides/literated/GettingStarted/">Getting started</a></li><li><a class="tocitem" href="../guides/literated/Parameters/">Handling parameters</a></li><li><a class="tocitem" href="../guides/literated/SimpleModel/">Building a model</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../IceNucleationParcel0D/">Adiabatic parcel model</a></li><li><a class="tocitem" href="../IceNucleationBox0D/">Box Model</a></li></ul></li><li><a class="tocitem" href="../API/">API</a></li><li><a class="tocitem" href="../DevelopersGuide/">Developer&#39;s Guide</a></li><li><a class="tocitem" href="../Glossary/">Glossary</a></li><li><a class="tocitem" href="../References/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Parameterizations</a></li><li class="is-active"><a href>Aerosol activation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Aerosol activation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CliMA/CloudMicrophysics.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CliMA/CloudMicrophysics.jl/blob/main/docs/src/AerosolActivation.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Aerosol-Activation"><a class="docs-heading-anchor" href="#Aerosol-Activation">Aerosol Activation</a><a id="Aerosol-Activation-1"></a><a class="docs-heading-anchor-permalink" href="#Aerosol-Activation" title="Permalink"></a></h1><p>The <code>AerosolActivation.jl</code> module contains parameterization   of activation of aerosol particles into cloud droplets   via deposition of water vapor. Accompanying it, is the <code>AerosolDistribution.jl</code> module, which contains   information about the aerosol size distribution and chemical properties. The parameterization computes the total activated number and mass   from a given aerosol size distribution. It is based on <a href="https://en.wikipedia.org/wiki/K%C3%B6hler_theory">Köhler theory</a>   and assumes equilibrium thermodynamics. The modules are an implementation of the parameterization   from [<a href="../References/#Abdul-Razzaketal1998">36</a>] and   [<a href="../References/#Abdul-RazzakandGhan2000">37</a>]. The aerosol chemical composition can be expressed using the B parameter   from [<a href="../References/#Abdul-RazzakandGhan2000">37</a>]   or the kappa parameter from [<a href="../References/#PettersandKreidenweis2007">38</a>].</p><h2 id="Assumed-aerosol-size-distribution-and-properties"><a class="docs-heading-anchor" href="#Assumed-aerosol-size-distribution-and-properties">Assumed aerosol size distribution and properties</a><a id="Assumed-aerosol-size-distribution-and-properties-1"></a><a class="docs-heading-anchor-permalink" href="#Assumed-aerosol-size-distribution-and-properties" title="Permalink"></a></h2><p>Aerosol particles are assumed to follow a multi-mode lognormal   size distribution. Particles in each mode are assumed to be internally mixed. The following table lists the parameters defining the aerosol   physical and chemical properties using the B parameter. The <span>$r_{dry}$</span>, <span>$\sigma$</span>, and <span>$N_{tot}$</span> are given for each mode. Other parameters are defined for each component in each mode.</p><table><tr><th style="text-align: right">variable name</th><th style="text-align: right">definition</th><th style="text-align: right">units</th></tr><tr><td style="text-align: right"><span>$r_{dry}$</span></td><td style="text-align: right">geometric mean dry radius</td><td style="text-align: right"><span>$m$</span></td></tr><tr><td style="text-align: right"><span>$\sigma$</span></td><td style="text-align: right">geometric standard deviation</td><td style="text-align: right"><span>$-$</span></td></tr><tr><td style="text-align: right"><span>$N_{tot}$</span></td><td style="text-align: right">total number concentration</td><td style="text-align: right"><span>$m^{-3}$</span></td></tr><tr><td style="text-align: right"><span>$r$</span></td><td style="text-align: right">component mass mixing ratio</td><td style="text-align: right"><span>$-$</span></td></tr><tr><td style="text-align: right"><span>$\epsilon$</span></td><td style="text-align: right">mass fraction of water soluble material</td><td style="text-align: right"><span>$-$</span></td></tr><tr><td style="text-align: right"><span>$\phi$</span></td><td style="text-align: right">osmotic coefficient</td><td style="text-align: right"><span>$-$</span></td></tr><tr><td style="text-align: right"><span>$M_a$</span></td><td style="text-align: right">molar mass</td><td style="text-align: right"><span>$kg \, mol^{-1}$</span></td></tr><tr><td style="text-align: right"><span>$\nu$</span></td><td style="text-align: right">number of ions the salt dissociates into in water</td><td style="text-align: right"><span>$-$</span></td></tr><tr><td style="text-align: right"><span>$\rho_a$</span></td><td style="text-align: right">aerosol density</td><td style="text-align: right"><span>$kg \, m^{-3}$</span></td></tr></table><p>When using the kappa formulation, one has to specify fewer parameters.</p><table><tr><th style="text-align: right">variable name</th><th style="text-align: right">definition</th><th style="text-align: right">units</th></tr><tr><td style="text-align: right"><span>$r_{dry}$</span></td><td style="text-align: right">geometric mean dry radius</td><td style="text-align: right"><span>$m$</span></td></tr><tr><td style="text-align: right"><span>$\sigma$</span></td><td style="text-align: right">geometric standard deviation</td><td style="text-align: right"><span>$-$</span></td></tr><tr><td style="text-align: right"><span>$N_{tot}$</span></td><td style="text-align: right">total number concentration</td><td style="text-align: right"><span>$m^{-3}$</span></td></tr><tr><td style="text-align: right"><span>$r_{vol}$</span></td><td style="text-align: right">component volume mixing ratio</td><td style="text-align: right"><span>$-$</span></td></tr><tr><td style="text-align: right"><span>$M_a$</span></td><td style="text-align: right">molar mass</td><td style="text-align: right"><span>$kg \, mol^{-1}$</span></td></tr><tr><td style="text-align: right"><span>$\kappa$</span></td><td style="text-align: right">kappa parameter</td><td style="text-align: right"><span>$-$</span></td></tr></table><div class="admonition is-info" id="Note-3eed1754c2edf742"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-3eed1754c2edf742" title="Permalink"></a></header><div class="admonition-body"><p>The parameterization assumes that the solute is sufficiently soluble so that its concentration does not increase as the droplet grows. The effects of surfactants on surface tension are also not considered.</p></div></div><h2 id="Mean-Hygroscopicity"><a class="docs-heading-anchor" href="#Mean-Hygroscopicity">Mean Hygroscopicity</a><a id="Mean-Hygroscopicity-1"></a><a class="docs-heading-anchor-permalink" href="#Mean-Hygroscopicity" title="Permalink"></a></h2><p>Hygroscopicity describes the impact of solute on aerosol efficiency in taking up   water vapor from the environment (i.e. the <a href="https://en.wikipedia.org/wiki/Raoult%27s_law">Raoult&#39;s law</a>). The parametrization accepts two ways of describing it, either using the   <span>$B$</span> parameter or <span>$\kappa$</span> parameter. The <span>$B$</span> parameter is defined in eq. (3) in [<a href="../References/#Abdul-RazzakandGhan2000">37</a>]:</p><p class="math-container">\[B = \frac{\nu \, \phi \, M_w \, \rho_a}{M_a \, \rho_w}\]</p><p>where:</p><ul><li><span>$\nu, \, \phi, \, M_a, \, \rho_a$</span> are the aerosol properties defined in the above table,</li><li><span>$M_w$</span> is the molar mass of water,</li><li><span>$\rho_w$</span> is the density of water.</li></ul><p>The mean <span>$B$</span> parameter for internally mixed mode <span>$i$</span>   made up of <span>$j$</span> aerosol species is computed   according to eq. (4) in [<a href="../References/#Abdul-RazzakandGhan2000">37</a>]:</p><p class="math-container">\[\begin{equation}
\bar{B_i} = \frac{M_w \sum_{j = 1}^{J} \frac{r_{ij} \, \nu_{ij} \, \phi_{ij} \, \epsilon_{ij}}{M_{aij}}}{\rho_w \sum_{j = 1}^{J} \frac{r_{ij}}{\rho_{aij}}}
\end{equation}\]</p><p>where:</p><ul><li><span>$i = 1, 2, ..., I$</span> iterates over aerosol size distribution modes,</li><li><span>$j = 1, 2, ..., J$</span> iterates over aerosol components within a given mode,</li><li><span>$r_{ij}$</span> is the mass ratio of component <span>$j$</span> in mode <span>$i$</span>.</li></ul><p>The <span>$\kappa$</span> parameter values for different chemical compounds are provided   in Table 1 in  [<a href="../References/#PettersandKreidenweis2007">38</a>]. The mean <span>$\kappa$</span> parameter for internally mixed mode <span>$i$</span>   made up of <span>$j$</span> aerosol species is computed as a volume weighted average:</p><p class="math-container">\[\kappa_i = \sum_{j=1}^{J} r_{ij,\, vol} \kappa_{ij}\]</p><p>where:</p><ul><li><span>$r_{ij, \, vol}$</span> is the volume ratio of component <span>$j$</span> in mode <span>$i$</span>.</li></ul><h2 id="Critical-supersaturation"><a class="docs-heading-anchor" href="#Critical-supersaturation">Critical supersaturation</a><a id="Critical-supersaturation-1"></a><a class="docs-heading-anchor-permalink" href="#Critical-supersaturation" title="Permalink"></a></h2><p>Supersaturation <span>$S$</span> is the ratio of water vapor pressure to saturation vapor pressure. Köhler theory defines <span>$S$</span> at which the growing aerosol particle   is in equilibrium with the environment over a range of its sizes. It takes into account the curvature effects and the solute effects. Aerosol activation occurs when the threshold supersaturation,   named critical supersaturation <span>$S_c$</span>, is reached. After reaching <span>$S_c$</span>, even when <span>$S$</span> decreases,   as long as the conditions remain saturated,   the particle will continue to grow. The critical supersaturation is defined by the maximum of the   <a href="https://en.wikipedia.org/wiki/K%C3%B6hler_theory">Köhler curve</a>. For example, eq.(9) in [<a href="../References/#Abdul-RazzakandGhan2000">37</a>] defines the   the critical supersaturation for a particle with   dry radius equal to the mean mode radius:</p><p class="math-container">\[\begin{equation}
S_{ci} = \frac{2}{\sqrt{\bar{H_{i}}}} \bigg( \frac{A}{3 \, r_{dry, \, i}} \bigg)^{3/2}
\label{eq:Scriti}
\end{equation}\]</p><p>where:</p><ul><li><span>$H_i$</span> is either the <span>$B_i$</span> or the <span>$\kappa_i$</span> hygroscopicity parameter</li><li><span>$A$</span> is the coefficient describing the curvature effects (i.e. <a href="https://en.wikipedia.org/wiki/Kelvin_equation">Kelvin effect</a>),</li><li><span>$r_{dry \, i}$</span> is the mean dry radius for mode <span>$i$</span>.</li></ul><p>Coefficient <span>$A$</span> is defined as in equation (5) in [<a href="../References/#Abdul-Razzaketal1998">36</a>].</p><p class="math-container">\[\begin{equation}
A = \frac{2 \tau M_w}{\rho_w R T}
\end{equation}\]</p><p>where:</p><ul><li><span>$\tau$</span> is the surface tension of water,</li><li><span>$R$</span> is the universal gas constant,</li><li><span>$T$</span> is the temperature.</li></ul><h2 id="Maximum-Supersaturation"><a class="docs-heading-anchor" href="#Maximum-Supersaturation">Maximum Supersaturation</a><a id="Maximum-Supersaturation-1"></a><a class="docs-heading-anchor-permalink" href="#Maximum-Supersaturation" title="Permalink"></a></h2><p>Maximum supersaturation reached by the system <span>$S_{max}$</span> governs what aerosol sizes are activated and what aren&#39;t. We estimate <span>$S_{max}$</span> by considering a parcel of air raising adiabatically with a constant velocity, see for example [<a href="../References/#KorolevMazin2003">39</a>]. The time rate of change of <span>$S$</span> is given by eq (A11) in [<a href="../References/#KorolevMazin2003">39</a>]</p><p class="math-container">\[\begin{equation}
  \frac{dS}{dt} = \alpha w - \gamma \frac{d\chi}{dt}
  \label{eq:Sevolution}
\end{equation}\]</p><p>where:</p><ul><li><span>$w$</span> is the vertical velocity,</li><li><span>$d\chi / dt$</span> is the water condensation rate during aerosol activation and growth,</li><li><span>$\alpha$</span> and <span>$\gamma$</span> are coefficients that do not depend on aerosol properties.</li></ul><p>The parameters <span>$\alpha$</span> and <span>$\gamma$</span> are defined similarly to eq. (11) and (12) in [<a href="../References/#Abdul-Razzaketal1998">36</a>], but we follow the full formulation from [<a href="../References/#KorolevMazin2003">39</a>] eq. (A11), without assuming <span>$S + 1 ≈ 1$</span>. While the difference is often small, we retain the full expressions for completeness and consistency with our implementation. The parameters are:</p><p class="math-container">\[\begin{equation}
\alpha = \frac{p_{vap}}{p_{vap}^{sat}}\left[\frac{L_v \, g}{R_v \, c_{pm} \, T^2} - \frac{g}{R_m \, T}\right]
\end{equation}\]</p><p class="math-container">\[\begin{equation}
\gamma = \frac{R_v T}{p_{vap}^{sat}} + \frac{p_{vap}}{p_{vap}^{sat}}\frac{R_m \, L_v^2}{R_v \, c_{pm} \, T \, p}
\end{equation}\]</p><p>where:</p><ul><li><span>$L_v$</span> is the latent heat of vaporization,</li><li><span>$g$</span> is gravitational acceleration,</li><li><span>$R_v$</span> is the gas constant of vapor,</li><li><span>$R_m$</span> is the gas constant of air (dry air and moisture)</li><li><span>$c_{pm}$</span> is the specific heat of air (dry air and moisture),</li><li><span>$p_{vap}$</span> is the vapor pressure,</li><li><span>$p_{vap}^{sat}$</span> is the saturation vapor pressure,</li><li><span>$p$</span> is the total air pressure.</li></ul><p>The maximum supersaturation is estimated from eq. (\ref{eq:Sevolution})   assuming steady a state solution <span>$dS/dt = 0$</span>. [<a href="../References/#Abdul-Razzaketal1998">36</a>] and [<a href="../References/#Abdul-RazzakandGhan2000">37</a>]   show how to derive an approximate solution for <span>$S_{max}$</span>,   since analytical solution is in general not possible. They consider approximate solutions for very small and very large   critical supersaturation values relative to maximum supersaturation,   and combine them into a final expression for <span>$S_{max}$</span>. The final formula is presented in eq (6) in [<a href="../References/#Abdul-RazzakandGhan2000">37</a>]</p><p class="math-container">\[\begin{equation}
S_{max} = \frac{1}{\Bigg\{ {\sum_{i=1}^{I}\frac{1}{S_{ci}^{2}}\bigg[f_i \Big( \frac{\zeta}{\eta_{i}} \Big)^{\frac{3}{2}} + g_{i} \Big(\frac{S_{ci}^{2}}{\eta_{i} + 3\zeta} \Big)^{\frac{3}{4}}\bigg]} \Bigg\}^{\frac{1}{2}}}
\end{equation}\]</p><p>where</p><ul><li><span>$S_{ci}$</span> is the critical supersaturation for mode <span>$i$</span> defined in eq. (\ref{eq:Scriti}),</li><li><span>$f_i$</span>, <span>$g_i$</span>, <span>$\zeta$</span>, <span>$\eta_i$</span> are the coefficients defined in eqs. (7, 8, 10 and 11) in  [<a href="../References/#Abdul-RazzakandGhan2000">37</a>].</li></ul><p class="math-container">\[\begin{equation}
f_i  = 0.5 \, \mathrm{exp} (2.5 \, \mathrm{ln}^{2} \sigma_{i})
\end{equation}\]</p><p class="math-container">\[\begin{equation}
g_i  = 1 + 0.25 \, \mathrm{ln} \sigma_i
\end{equation}\]</p><p class="math-container">\[\begin{equation}
\zeta = \frac{2A}{3} \bigg(\frac{\alpha w}{G}\bigg)^{\frac{1}{2}}
\end{equation}\]</p><p class="math-container">\[\begin{equation}
\eta_i = \bigg(\frac{\alpha w}{G}\bigg)^{\frac{3}{2}} \frac{1}{2 \pi \rho_w \gamma N_i}
\end{equation}\]</p><p>where:</p><ul><li><span>$G(T) = \frac{1}{\rho_w} \, \left(\frac{L_v}{KT} \left(\frac{L_v}{R_v T} - 1 \right) + \frac{R_v T}{p_{vap}^{sat} D} \right)^{-1}$</span>   combines the effects of thermal conductivity <span>$K$</span> and water diffusivity <span>$D$</span>.</li></ul><h2 id="Number-and-mass-of-activated-particles"><a class="docs-heading-anchor" href="#Number-and-mass-of-activated-particles">Number and mass of activated particles</a><a id="Number-and-mass-of-activated-particles-1"></a><a class="docs-heading-anchor-permalink" href="#Number-and-mass-of-activated-particles" title="Permalink"></a></h2><p>The total number <span>$N_{act}$</span> and mass <span>$M_{act}$</span> of activated aerosol particles   can be computed by integrating their size distribution   starting from the smallest activated size. Following the derivations of   [<a href="../References/#Abdul-Razzaketal1998">36</a>] and [<a href="../References/#Abdul-RazzakandGhan2000">37</a>]   this can be expressed in terms of critical supersaturations of each   size distribution mode <span>$S_{ci}$</span> and the maximum supersaturation <span>$S_{max}$</span>.</p><p class="math-container">\[\begin{equation}
N_{act} = \sum_{i = 1}^{I} N_{i}\frac{1}{2}\bigg[1 - \mathrm{erf}(u_{i})\bigg]
\end{equation}\]</p><p class="math-container">\[\begin{equation}
M_{act} = \sum_{i = 1}^{I} M_{i}\frac{1}{2}\bigg[1 - \mathrm{erf}\bigg(u_{i} - \frac{3 \sqrt2}{2} ln(\sigma_i)\bigg)\bigg]
\end{equation}\]</p><p>where:</p><ul><li><span>$M_i$</span> is the average molar mass of aerosol particles in mode <span>$i$</span>,</li><li><span>$u_i$</span> is given in equation (15) in [<a href="../References/#Abdul-RazzakandGhan2000">37</a>].</li></ul><p class="math-container">\[\begin{equation}
u_i = \frac{2}{3\sqrt2 \, ln(\sigma_i)} ln\bigg( \frac{S_{ci}}{S_{max}} \bigg)
\end{equation}\]</p><p>where:</p><ul><li><span>$S_{ci}$</span> is the mode critical supersaturation,</li><li><span>$S_{max}$</span> is the maximum supersaturation.</li></ul><h2 id="Example-of-Aerosol-Activation-from-ARG2000"><a class="docs-heading-anchor" href="#Example-of-Aerosol-Activation-from-ARG2000">Example of Aerosol Activation from ARG2000</a><a id="Example-of-Aerosol-Activation-from-ARG2000-1"></a><a class="docs-heading-anchor-permalink" href="#Example-of-Aerosol-Activation-from-ARG2000" title="Permalink"></a></h2><p>The figures below have been reproduced from [<a href="../References/#Abdul-RazzakandGhan2000">37</a>] using the aerosol activation parameterization implemented in this project.</p><pre><code class="language-julia hljs">include(&quot;plots/ARGplots_fig1.jl&quot;)</code></pre><img src="e90c4703.png" alt="Example block output"/><p><img src="../Abdul-Razzak_and_Ghan_fig_1.svg" alt/></p><pre><code class="language-julia hljs">include(&quot;plots/ARGplots.jl&quot;)
make_ARG_figX(2)
make_ARG_figX(3)
make_ARG_figX(4)
make_ARG_figX(5)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;/home/runner/work/CloudMicrophysics.jl/CloudMicrophysics.jl/docs/build/Abdul-Razzak_and_Ghan_fig_5.svg&quot;</code></pre><p><img src="../Abdul-Razzak_and_Ghan_fig_2.svg" alt/> <img src="../Abdul-Razzak_and_Ghan_fig_3.svg" alt/> <img src="../Abdul-Razzak_and_Ghan_fig_4.svg" alt/> <img src="../Abdul-Razzak_and_Ghan_fig_5.svg" alt/></p><h2 id="Aerosol-activation-prediction-with-ML-emulators-and-EKP-calibration"><a class="docs-heading-anchor" href="#Aerosol-activation-prediction-with-ML-emulators-and-EKP-calibration">Aerosol activation prediction with ML emulators and EKP calibration</a><a id="Aerosol-activation-prediction-with-ML-emulators-and-EKP-calibration-1"></a><a class="docs-heading-anchor-permalink" href="#Aerosol-activation-prediction-with-ML-emulators-and-EKP-calibration" title="Permalink"></a></h2><p>The CloudMicrophysics package offers an advanced feature for predicting the aerosol activation fraction using machine-learned emulators. Users have access to a function that utilizes pre-trained models for the prediction of activation fraction. Additionally, the package includes tools for training machine learning models, tailored to specific datasets or needs. The training process can benefit from incorporating the ARG activation equation, enhancing the relevance of training data. Emulator training, covering neural networks, Gaussian processes, and EvoTrees, is showcased in <code>test/aerosol_activation_emulators.jl</code>.</p><p>In addition, we provide functionality and a demonstration for re-training the free parameters of the traditional ARG activation scheme using Ensemble Kalman Processes. This functionality is showcased in <code>test/aerosol_activation_calibration.jl</code>.</p><p>Using ML emulators or calibration with Ensemble Kalman Processes for predicting aerosol activation is provided through an extension to the main package. This extension will be loaded with <code>CloudMicrophysics.jl</code> if both <code>MLJ.jl</code>, <code>DataFrames.jl</code>, and <code>EnsembleKalmanProcesses.jl</code> are loaded by the user as well.</p><h2 id="Modification-for-Local-Supersaturation-with-Preexisting-Hydrometeors"><a class="docs-heading-anchor" href="#Modification-for-Local-Supersaturation-with-Preexisting-Hydrometeors">Modification for Local Supersaturation with Preexisting Hydrometeors</a><a id="Modification-for-Local-Supersaturation-with-Preexisting-Hydrometeors-1"></a><a class="docs-heading-anchor-permalink" href="#Modification-for-Local-Supersaturation-with-Preexisting-Hydrometeors" title="Permalink"></a></h2><p>The original ARG activation scheme assumes adiabatic ascent with no preexisting cloud or ice particles, which is a valid approximation near cloud base. As a result, the ARG formulation is traditionally applied only at cloud base, where no vapor has yet condensed and no hydrometeors exist to affect the supersaturation evolution.</p><p>However, in many applications—such as large-eddy simulations or cloud-resolving models—it is desirable to apply the activation scheme locally, throughout the vertical extent of the cloud. In such cases, preexisting cloud droplets and ice crystals act as persistent vapor sinks, suppressing supersaturation and inhibiting further activation.</p><p>To relax the cloud-base-only constraint and extend ARG into a local operator, we propose modifying the supersaturation tendency equation by incorporating the effects of these preexisting hydrometeors. When coupling this approach to a full model, additional clipping may be needed: the modified ARG should only be applied when the local supersaturation does not exceed the predicted maximum, and when the number concentration of hydrometeors remains below the potential activation of aerosols.</p><h3 id="Modified-Supersaturation-Budget"><a class="docs-heading-anchor" href="#Modified-Supersaturation-Budget">Modified Supersaturation Budget</a><a id="Modified-Supersaturation-Budget-1"></a><a class="docs-heading-anchor-permalink" href="#Modified-Supersaturation-Budget" title="Permalink"></a></h3><p>We modify the supersaturation tendency equation to include additional vapor sink terms:</p><p class="math-container">\[\frac{dS}{dt} = \alpha w - \gamma \frac{d\chi}{dt}_{\text{activation}} - \gamma \frac{d\chi}{dt}_{\text{liquid}} - \gamma_i \frac{d\chi}{dt}_{\text{ice}},\]</p><p>where the thermodynamic coefficient <span>$\gamma_i$</span> is defined as</p><p class="math-container">\[\begin{equation}
\gamma_i = \frac{R_v T}{p_{vap}^{sat}} + \frac{p_{vap}}{p_{vap}^{sat}}\frac{R_m \, L_v L_s}{R_v \, c_{pm} \, T \, p}
\end{equation}\]</p><p>where <span>$L_s$</span> is the latent heat of sublimation. The new sink terms are:</p><ul><li>Liquid sink:</li></ul><p class="math-container">\[\frac{d\chi}{dt}_{\text{liquid}} = 4 \pi \rho_w N_l r_l G_l S,\]</p><ul><li>Ice sink:</li></ul><p class="math-container">\[\frac{d\chi}{dt}_{\text{ice}} = 4 \pi \rho_i N_i r_i G_i S_i,\]</p><p>with</p><p class="math-container">\[S_i = \xi (S + 1) - 1, \quad \xi = \frac{e_{s,\ell}}{e_{s,i}}.\]</p><p>Here:</p><ul><li><span>$N_l$</span>, <span>$r_l$</span>, and <span>$G_l$</span> are the number concentration, radius, and condensational growth coefficient of liquid droplets,</li><li><span>$N_i$</span>, <span>$r_i$</span>, and <span>$G_i$</span> are the corresponding values for ice crystals,</li><li><span>$\rho_w$</span> and <span>$\rho_i$</span> are the densities of liquid water and ice.</li></ul><p>We define:</p><p class="math-container">\[K_l = 4 \pi \rho_w N_l r_l G_l \gamma, \quad K_i = 4 \pi \rho_i N_i r_i G_i \gamma_i,\]</p><p>yielding the modified supersaturation equation at peak supersaturation:</p><p class="math-container">\[0 = \alpha w - \gamma f(S_{max}) - K_l S_{max} - K_i \big[ \xi (S_{max} + 1) - 1 \big].\]</p><h3 id="Approximate-Solution"><a class="docs-heading-anchor" href="#Approximate-Solution">Approximate Solution</a><a id="Approximate-Solution-1"></a><a class="docs-heading-anchor-permalink" href="#Approximate-Solution" title="Permalink"></a></h3><p>Let <span>$S_0$</span> be the ARG solution obtained by solving:</p><p class="math-container">\[\alpha w = \gamma f(S_0),\]</p><p>and approximate the nonlinear sink function <span>$f(S)$</span> as linear between 0 and <span>$S_0$</span>:</p><p class="math-container">\[f(S) \approx f(S_0) \cdot \frac{S}{S_0}.\]</p><p>Substituting into the modified budget and solving for <span>$S_1$</span>:</p><p class="math-container">\[\alpha w = \gamma f(S_0) \cdot \frac{S_1}{S_0} + K_l S_1 + K_i \big[\xi (S_1 + 1) - 1 \big],\]</p><p>yields:</p><p class="math-container">\[S_1 = \frac{(\alpha w - K_i (\xi - 1)) S_0}{\alpha w + (K_l + K_i \xi) S_0}.\]</p><p>The final expression for the modified supersaturation becomes:</p><p class="math-container">\[S_{\text{max}}^{\text{modified}} = \frac{(\alpha w - K_i (\xi - 1)) S_{\text{max}}^{\text{ARG}}}{\alpha w + (K_l + K_i \xi) S_{\text{max}}^{\text{ARG}}}.\]</p><ul><li>When <span>$K_l = K_i = 0$</span>, the formula reduces to the original ARG solution.</li><li>Larger values of <span>$K_l$</span> or <span>$K_i$</span> reduce the supersaturation due to vapor uptake by preexisting hydrometeors.</li><li>This extension allows the ARG activation scheme to be applied at any vertical level, making it suitable for use as a local operator in models that resolve cloud-scale dynamics.</li></ul><h3 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h3><p>To illustrate the behavior of the modified ARG scheme, we compare the maximum supersaturation it predicts against that from a detailed parcel model in four idealized scenarios:</p><ul><li>Varying the liquid droplet number concentration with no ice particles present,</li><li>Varying the ice crystal number concentration with no liquid droplets present,</li><li>Varying the initial droplet radius with no ice particles present,</li><li>Varying the initial ice particle radius with no liquid droplets present.</li></ul><p>In all cases, the parcel model assumes an initial zero supersaturation and includes activation, condensational growth, and depositional growth during adiabatic ascent. A background population of sulfate aerosol with an initial concentration of 500 cm⁻³ is present in all scenarios. For simplicity, ice particles are assumed to be monodisperse. Liquid droplets formed through activation and those present initially are represented as two separate monodisperse populations.</p><p>The figure below shows the ratio of the maximum supersaturation reached in the parcel model to that predicted by the modified ARG scheme. This comparison highlights the conditions under which the modified ARG provides a good approximation to the more detailed parcel-model results.</p><pre><code class="language-julia hljs">include(&quot;plots/ARGmodified_plots.jl&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">CairoMakie.Screen{SVG}
</code></pre><p><img src="../parcel_vs_modifiedARG_aerosol_activation.svg" alt/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ThresholdsTransition/">« Smooth transition at thresholds</a><a class="docs-footer-nextpage" href="../WaterActivity/">Water Activity »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Wednesday 4 February 2026 19:56">Wednesday 4 February 2026</span>. Using Julia version 1.11.8.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
